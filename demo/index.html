<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mission Control â€” Demo</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--bg:#070d14;--surface:#0c1520;--surface2:#111d2b;--surface3:#172536;
--border:#1e2d3d;--border-hover:#2a3d52;--text:#e4e4e8;--text2:#7a8ba0;
--accent:#0D1B2A;--accent-light:#1a3050;
--yellow:#f0c040;--green:#40c080;--blue:#4080f0;--red:#f04060;--purple:#a060f0;
--radius:12px;
--glass:rgba(12,21,32,.6);--glass-border:rgba(255,255,255,.06);
}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);height:100dvh;overflow:hidden;display:flex;position:relative}
body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.03;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")}
a{color:var(--blue);text-decoration:none}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--surface3);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--border)}

.sidebar{width:240px;background:var(--glass);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-right:1px solid var(--glass-border);display:flex;flex-direction:column;flex-shrink:0;height:100vh;z-index:2}
.sidebar-logo{padding:20px;border-bottom:1px solid var(--glass-border)}
.sidebar-logo .title{font-size:11px;font-weight:700;letter-spacing:3px;color:var(--blue);text-transform:uppercase}
.sidebar-logo .sub{display:block;font-size:13px;font-weight:600;color:var(--text);margin-top:4px}
.nav{flex:1;padding:8px 12px;overflow-y:auto}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 14px;border-radius:8px;cursor:pointer;color:var(--text2);font-size:13px;font-weight:500;transition:all .2s cubic-bezier(.4,0,.2,1);position:relative}
.nav-item:hover{background:rgba(255,255,255,.04);color:var(--text)}
.nav-item.active{background:rgba(64,128,240,.12);color:#fff}
.nav-item.active::before{content:'';position:absolute;left:-12px;top:50%;transform:translateY(-50%);width:3px;height:18px;background:var(--blue);border-radius:0 3px 3px 0}
.nav-item svg{width:16px;height:16px;opacity:.5;flex-shrink:0}.nav-item.active svg{opacity:1}
.nav-badge{position:absolute;right:10px;font-size:10px;font-weight:700;background:rgba(64,128,240,.15);color:var(--blue);padding:2px 7px;border-radius:10px;min-width:20px;text-align:center}
.nav-item.active .nav-badge{background:rgba(255,255,255,.15);color:#fff}
.sidebar-footer{padding:14px;border-top:1px solid var(--glass-border);text-align:center}
.sidebar-footer a{font-size:11px;color:var(--text2);opacity:.6;transition:opacity .2s}
.sidebar-footer a:hover{opacity:1;color:var(--blue)}

.main{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:32px 40px;padding-bottom:80px;position:relative;z-index:1;min-height:0}
.section{display:none;animation:fadeIn .4s cubic-bezier(.4,0,.2,1)}.section.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes cardIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

#login{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:100;background:linear-gradient(-45deg,#0a0a0f,#0d1520,#0a1228,#0f0a1a);background-size:400% 400%;animation:grad 15s ease infinite}
#login.hidden{display:none}
@keyframes grad{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
.login-box{background:rgba(12,21,32,.7);backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);border:1px solid var(--glass-border);border-radius:16px;padding:48px;width:360px;text-align:center;animation:loginIn .6s cubic-bezier(.4,0,.2,1)}
@keyframes loginIn{from{opacity:0;transform:translateY(20px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}
.login-box h1{font-size:20px;margin-bottom:4px;font-weight:700}
.login-box .login-sub{font-size:11px;font-weight:600;letter-spacing:2px;color:var(--blue);text-transform:uppercase;margin-bottom:24px}
.login-box input{width:100%;padding:12px 16px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:14px;font-family:inherit;outline:none;transition:all .3s}
.login-box input:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(64,128,240,.15)}
.login-box button{width:100%;padding:12px;margin-top:12px;background:var(--blue);border:none;border-radius:8px;color:#fff;font-size:14px;font-weight:600;cursor:pointer;font-family:inherit;transition:all .15s}
.login-box button:hover{background:#5090ff}
.login-box button:active{transform:scale(.97)}
.login-error{color:var(--red);font-size:12px;margin-top:8px;display:none}

.glass-card{background:var(--glass);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);transition:all .25s cubic-bezier(.4,0,.2,1)}
.glass-card:hover{border-color:var(--border-hover);box-shadow:0 4px 24px rgba(0,0,0,.2),inset 0 1px 0 rgba(255,255,255,.03)}

.page-title{font-size:24px;font-weight:700;margin-bottom:4px;letter-spacing:-.02em}
.page-sub{color:var(--text2);font-size:14px;margin-bottom:28px}
.clock{font-size:13px;color:var(--text2);margin-bottom:24px;font-variant-numeric:tabular-nums}

.mission-statement{background:linear-gradient(135deg,rgba(10,22,40,.8),rgba(22,40,64,.6),rgba(26,48,80,.5));backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:28px;margin-bottom:28px;position:relative;overflow:hidden}
.mission-statement::before{content:'';position:absolute;top:-50%;right:-50%;width:200%;height:200%;background:radial-gradient(circle at 70% 30%,rgba(64,128,240,.08),transparent 60%);pointer-events:none}
.mission-statement h2{font-size:11px;color:var(--text2);font-weight:600;margin-bottom:8px;text-transform:uppercase;letter-spacing:2px}
.mission-statement p{font-size:18px;font-weight:500;line-height:1.6;position:relative}
.mission-statement .tag{display:inline-block;margin-top:12px;font-size:12px;color:var(--blue);font-weight:600;padding:4px 12px;background:rgba(64,128,240,.1);border-radius:20px;border:1px solid rgba(64,128,240,.15)}

.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:14px;margin-bottom:28px}
.stat-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;position:relative;overflow:hidden;opacity:1;animation:cardIn .5s cubic-bezier(.4,0,.2,1) forwards;transition:all .25s}
.stat-card:nth-child(1){animation-delay:.05s}.stat-card:nth-child(2){animation-delay:.1s}.stat-card:nth-child(3){animation-delay:.15s}.stat-card:nth-child(4){animation-delay:.2s}.stat-card:nth-child(5){animation-delay:.25s}.stat-card:nth-child(6){animation-delay:.3s}.stat-card:nth-child(7){animation-delay:.35s}
.stat-card:hover{border-color:var(--border-hover);transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.2)}
.stat-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;border-radius:3px 0 0 3px}
.stat-card:nth-child(1)::before{background:linear-gradient(180deg,var(--yellow),rgba(240,192,64,.2))}.stat-card:nth-child(2)::before{background:linear-gradient(180deg,var(--green),rgba(64,192,128,.2))}.stat-card:nth-child(3)::before{background:linear-gradient(180deg,var(--blue),rgba(64,128,240,.2))}.stat-card:nth-child(4)::before{background:linear-gradient(180deg,var(--purple),rgba(160,96,240,.2))}.stat-card:nth-child(5)::before{background:linear-gradient(180deg,var(--red),rgba(240,64,96,.2))}.stat-card:nth-child(6)::before{background:linear-gradient(180deg,#40c0c0,rgba(64,192,192,.2))}.stat-card:nth-child(7)::before{background:linear-gradient(180deg,#c080f0,rgba(192,128,240,.2))}
.stat-card .label{font-size:11px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;font-weight:500}
.stat-card .value{font-size:28px;font-weight:700}

.feed-item{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;transition:all .25s;opacity:1;animation:cardIn .5s cubic-bezier(.4,0,.2,1) forwards}
.feed-item:hover{border-color:var(--border-hover)}
.feed-item .feed-header{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.feed-item .feed-icon{font-size:18px;flex-shrink:0}
.feed-item .feed-date{font-size:12px;color:var(--blue);font-weight:600;letter-spacing:.5px}
.feed-item .feed-content{font-size:14px;line-height:1.7}
.feed-item .feed-content strong{color:var(--text);font-weight:600}

.filter-bar{display:flex;align-items:center;gap:12px;margin-bottom:20px;flex-wrap:wrap}
.search-input{padding:9px 14px 9px 36px;background:var(--surface);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:13px;font-family:inherit;outline:none;width:260px;transition:all .25s}
.search-input:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(64,128,240,.1)}
.search-wrap{position:relative}.search-wrap svg{position:absolute;left:11px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--text2);pointer-events:none}
.filter-chip{padding:6px 14px;background:var(--surface);border:1px solid var(--border);border-radius:20px;color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;user-select:none}
.filter-chip:hover{background:var(--surface2);color:var(--text)}.filter-chip.active{background:rgba(64,128,240,.15);color:var(--blue);border-color:rgba(64,128,240,.3)}

.task-section-title{font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:1.5px;color:var(--text2);margin:24px 0 12px;padding-bottom:8px;border-bottom:1px solid var(--border)}.task-section-title:first-child{margin-top:0}
.task{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:8px;padding:14px 18px;margin-bottom:8px;transition:all .25s;opacity:1;animation:cardIn .4s cubic-bezier(.4,0,.2,1) forwards}
.task:hover{border-color:var(--border-hover);transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.2)}
.task-row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.badge{font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0}
.badge.high{background:rgba(240,64,96,.15);color:var(--red)}.badge.medium{background:rgba(240,192,64,.15);color:var(--yellow)}.badge.low{background:rgba(64,128,240,.15);color:var(--blue)}
.badge.in-progress{background:rgba(240,192,64,.15);color:var(--yellow)}.badge.completed{background:rgba(64,192,128,.15);color:var(--green)}.badge.waiting{background:rgba(64,128,240,.15);color:var(--blue)}.badge.blocked{background:rgba(240,64,96,.15);color:var(--red)}.badge.todo{background:rgba(152,152,176,.12);color:var(--text2)}
.task-name{font-size:14px;font-weight:500;flex:1;min-width:0}
.task-cat{font-size:11px;color:var(--text2);margin-left:4px}
.task-due{font-size:11px;color:var(--text2);white-space:nowrap}

.meeting-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;opacity:1;animation:cardIn .4s cubic-bezier(.4,0,.2,1) forwards;transition:all .25s;border-left:3px solid transparent;cursor:pointer}
.meeting-card:hover{border-color:var(--border-hover);transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.2)}
.meeting-card.today{border-left-color:var(--green)}
.meeting-card .meeting-header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.meeting-card .meeting-title{font-size:15px;font-weight:600;margin-bottom:4px}
.meeting-card .meeting-meta{font-size:12px;color:var(--text2);display:flex;flex-wrap:wrap;gap:12px;margin-top:6px}
.meeting-badge{font-size:10px;font-weight:700;padding:2px 8px;border-radius:10px;text-transform:uppercase;letter-spacing:.5px}
.meeting-badge.today-badge{background:rgba(64,192,128,.15);color:var(--green)}
.meeting-badge.upcoming-badge{background:rgba(64,128,240,.15);color:var(--blue)}
.meeting-attendees{display:flex;gap:4px;flex-wrap:wrap;margin-top:8px}
.meeting-attendee{font-size:11px;padding:2px 8px;background:var(--surface2);border:1px solid var(--border);border-radius:12px;color:var(--text2)}
.meeting-details{max-height:0;overflow:hidden;transition:max-height .3s cubic-bezier(.4,0,.2,1)}
.meeting-card.expanded .meeting-details{max-height:800px}
.meeting-prep{margin-top:16px;padding-top:12px;border-top:1px solid var(--border)}
.meeting-prep h4{font-size:11px;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:8px}
.prep-item{display:flex;align-items:flex-start;gap:8px;padding:8px 0;font-size:13px}
.prep-dot{width:8px;height:8px;border-radius:50%;margin-top:4px;flex-shrink:0}
.prep-dot.pending{background:var(--yellow)}.prep-dot.complete{background:var(--green)}
.prep-item .prep-response{font-size:12px;color:var(--text2);margin-top:4px;padding-left:16px}
.prep-input-wrap{display:flex;gap:8px;margin-top:12px}
.prep-input{flex:1;padding:8px 12px;background:var(--surface);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:13px;font-family:inherit;outline:none}
.prep-input:focus{border-color:var(--blue)}
.prep-submit{padding:8px 16px;background:var(--blue);border:none;border-radius:8px;color:#fff;font-size:12px;font-weight:600;cursor:pointer;font-family:inherit}
.prep-submit:hover{background:#5090ff}

.doc-card{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:16px 20px;margin-bottom:8px;display:flex;align-items:center;gap:14px;transition:all .25s;opacity:1;cursor:pointer}
.doc-card:hover{border-color:var(--border-hover);transform:translateY(-1px);background:rgba(255,255,255,.04)}
.doc-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0}
.doc-icon.pdf{background:rgba(240,64,96,.12)}.doc-icon.xlsx{background:rgba(64,192,128,.12)}.doc-icon.pptx{background:rgba(240,192,64,.12)}
.doc-title{font-size:14px;font-weight:500;flex:1}.doc-cat{font-size:11px;color:var(--text2)}.doc-date{font-size:11px;color:var(--text2)}.doc-size{font-size:11px;color:var(--text2)}

.agents-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
.agent-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:24px;transition:all .25s;opacity:1;animation:cardIn .5s cubic-bezier(.4,0,.2,1) forwards}
.agent-card:nth-child(1){animation-delay:.05s}.agent-card:nth-child(2){animation-delay:.1s}.agent-card:nth-child(3){animation-delay:.15s}
.agent-card:hover{border-color:var(--border-hover);transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.2)}
.agent-card .agent-name{font-size:18px;font-weight:700;margin-bottom:4px}
.agent-card .agent-role{font-size:13px;color:var(--text2);margin-bottom:14px}
.agent-card .agent-desc{font-size:14px;line-height:1.6}
.agent-status{display:inline-block;font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px;margin-bottom:12px;letter-spacing:.5px;text-transform:uppercase}
.agent-status.active{background:rgba(64,192,128,.15);color:var(--green);box-shadow:0 0 12px rgba(64,192,128,.1)}
.agent-status.standby{background:rgba(64,128,240,.15);color:var(--blue)}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.agent-status.active::before{content:'';display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--green);margin-right:6px;animation:pulse 2s ease-in-out infinite}
.agent-status.standby::before{content:'';display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--blue);margin-right:6px}
.agent-caps{display:flex;flex-wrap:wrap;gap:4px;margin-top:12px}
.agent-cap{font-size:10px;padding:2px 8px;background:var(--surface2);border:1px solid var(--border);border-radius:10px;color:var(--text2)}
.agent-meta{font-size:12px;color:var(--text2);margin-top:10px;display:flex;gap:16px}

.travel-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:0;margin-bottom:16px;overflow:hidden;transition:all .25s;opacity:1;animation:cardIn .5s cubic-bezier(.4,0,.2,1) forwards}
.travel-card:hover{border-color:var(--border-hover)}
.travel-card-header{padding:20px 24px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;user-select:none}
.travel-card-header:hover{background:rgba(255,255,255,.02)}
.travel-dest{font-size:17px;font-weight:700}.travel-dates{font-size:13px;color:var(--text2);margin-top:2px}
.travel-badge{display:inline-block;font-size:11px;font-weight:700;padding:3px 10px;border-radius:12px;text-transform:uppercase;letter-spacing:.5px}
.travel-badge.business{background:rgba(64,128,240,.15);color:var(--blue)}
.travel-status{font-size:11px;font-weight:600;padding:3px 10px;border-radius:12px;margin-left:8px}
.travel-status.upcoming{background:rgba(64,128,240,.12);color:var(--blue)}.travel-status.completed{background:rgba(152,152,176,.12);color:var(--text2)}
.travel-details{display:none;padding:0 24px 20px;border-top:1px solid var(--glass-border)}.travel-details.open{display:block}
.travel-section{margin-top:16px}
.travel-section-title{font-size:12px;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
.flight-route{display:flex;align-items:center;gap:12px;padding:12px 16px;background:var(--surface2);border-radius:8px;margin-bottom:8px}
.flight-airport{font-size:20px;font-weight:700;letter-spacing:1px}
.flight-arrow{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px}
.flight-arrow .line{width:100%;height:1px;background:var(--border);position:relative}
.flight-arrow .line::after{content:'âœˆ';position:absolute;right:-4px;top:-9px;font-size:14px}
.flight-arrow .flight-num{font-size:11px;color:var(--text2);font-weight:600}
.flight-time{font-size:12px;color:var(--text2)}
.flight-conf{font-size:11px;color:var(--blue);font-weight:600;margin-top:2px}
.hotel-card{padding:12px 16px;background:var(--surface2);border-radius:8px;margin-bottom:8px}
.hotel-name{font-size:14px;font-weight:600}.hotel-detail{font-size:12px;color:var(--text2);margin-top:4px}
.itin-day{padding:10px 16px;background:var(--surface2);border-radius:8px;margin-bottom:8px}
.itin-date{font-size:12px;font-weight:600;color:var(--blue);margin-bottom:6px}
.itin-item{font-size:13px;color:var(--text);padding:2px 0}
.travel-notes{padding:12px 16px;background:var(--surface2);border-radius:8px;font-size:13px;color:var(--text);line-height:1.6}

/* Health */
.health-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin-bottom:24px}
.health-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;opacity:1;animation:cardIn .5s forwards}
.health-card .h-label{font-size:11px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.health-card .h-value{font-size:32px;font-weight:700}
.health-card .h-sub{font-size:12px;color:var(--text2);margin-top:4px}
.bar-chart{display:flex;align-items:flex-end;gap:6px;height:80px;margin-top:12px}
.bar-chart .bar{flex:1;border-radius:4px 4px 0 0;transition:height .6s ease;position:relative;min-width:0}
.bar-chart .bar-label{position:absolute;bottom:-18px;left:50%;transform:translateX(-50%);font-size:10px;color:var(--text2);white-space:nowrap}
.sleep-breakdown{display:flex;gap:0;height:24px;border-radius:6px;overflow:hidden;margin:8px 0}
.sleep-segment{display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;color:#fff;transition:width .6s ease}

/* Security */
.security-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;transition:all .25s}
.security-card:hover{border-color:var(--border-hover)}
.security-status-badge{display:inline-block;font-size:12px;font-weight:600;padding:4px 12px;border-radius:20px;margin-bottom:12px;letter-spacing:.5px}
.security-status-badge.ok{background:rgba(64,192,128,.15);color:var(--green)}.security-status-badge.warn{background:rgba(240,192,64,.15);color:var(--yellow)}

/* Calls */
.call-item{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;transition:all .25s;opacity:1;animation:cardIn .5s forwards}
.call-item:hover{border-color:var(--border-hover)}
.call-header{display:flex;align-items:center;gap:10px;margin-bottom:10px;flex-wrap:wrap}
.call-title{font-size:15px;font-weight:600;flex:1;min-width:200px}
.call-date{font-size:12px;color:var(--text2)}
.call-badge{font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px;text-transform:uppercase;letter-spacing:.5px}
.call-badge.partnership{background:rgba(240,192,64,.15);color:var(--yellow)}.call-badge.enterprise{background:rgba(64,128,240,.15);color:var(--blue)}.call-badge.prospect{background:var(--surface3);color:var(--text2)}
.call-takeaways{list-style:none;padding:0}.call-takeaways li{padding:4px 0 4px 16px;position:relative;font-size:13px;line-height:1.6}.call-takeaways li::before{content:'â†’';position:absolute;left:0;color:var(--text2)}
.sandler-score{display:flex;align-items:center;gap:8px;margin:12px 0}
.sandler-bar{flex:1;height:8px;background:var(--surface3);border-radius:4px;overflow:hidden}
.sandler-fill{height:100%;border-radius:4px;transition:width .8s ease}
.sandler-label{font-size:12px;color:var(--text2);min-width:60px}

/* CRM Pipeline */
.pipeline-stages{display:flex;gap:2px;margin-bottom:24px;overflow-x:auto}
.pipeline-stage{flex:1;min-width:100px;padding:12px;text-align:center;background:var(--glass);border:1px solid var(--glass-border);border-radius:8px;font-size:12px;font-weight:600;color:var(--text2);transition:all .2s}
.pipeline-stage.active{background:rgba(64,128,240,.12);color:var(--blue);border-color:rgba(64,128,240,.3)}
.pipeline-stage .stage-count{font-size:20px;font-weight:700;color:var(--text);display:block;margin-top:4px}
.deal-card{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:18px 20px;margin-bottom:10px;transition:all .25s;opacity:1;animation:cardIn .4s forwards}
.deal-card:hover{border-color:var(--border-hover);transform:translateY(-2px)}
.deal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.deal-company{font-size:15px;font-weight:600}.deal-value{font-size:15px;font-weight:700;color:var(--green)}
.deal-meta{font-size:12px;color:var(--text2);display:flex;gap:16px;flex-wrap:wrap}
.deal-stage{font-size:11px;font-weight:600;padding:2px 8px;border-radius:10px}
.deal-stage.lead{background:rgba(152,152,176,.12);color:var(--text2)}
.deal-stage.qualified{background:rgba(64,128,240,.15);color:var(--blue)}
.deal-stage.proposal{background:rgba(240,192,64,.15);color:var(--yellow)}
.deal-stage.negotiation{background:rgba(160,96,240,.15);color:var(--purple)}
.deal-stage.closed-won{background:rgba(64,192,128,.15);color:var(--green)}

/* Email */
.email-card{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:16px 20px;margin-bottom:8px;transition:all .25s;opacity:1;animation:cardIn .4s forwards}
.email-card:hover{border-color:var(--border-hover);transform:translateY(-1px)}
.email-header{display:flex;align-items:center;gap:10px;margin-bottom:6px}
.email-from{font-size:14px;font-weight:600;flex:1}
.email-time{font-size:11px;color:var(--text2)}
.email-cat{font-size:10px;font-weight:700;padding:2px 8px;border-radius:10px;text-transform:uppercase;letter-spacing:.5px}
.email-cat.urgent{background:rgba(240,64,96,.15);color:var(--red)}.email-cat.needs-response{background:rgba(240,192,64,.15);color:var(--yellow)}.email-cat.fyi{background:rgba(64,128,240,.15);color:var(--blue)}.email-cat.promotional{background:rgba(152,152,176,.12);color:var(--text2)}
.email-subject{font-size:13px;font-weight:500;margin-bottom:4px}
.email-preview{font-size:12px;color:var(--text2);line-height:1.5}
.email-action{font-size:12px;color:var(--blue);margin-top:6px;font-weight:500}

/* Intel */
.intel-card{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;transition:all .25s;opacity:1;animation:cardIn .5s forwards}
.intel-card:hover{border-color:var(--border-hover)}
.intel-title{font-size:15px;font-weight:600;margin-bottom:6px}
.intel-meta{font-size:12px;color:var(--text2);margin-bottom:10px;display:flex;gap:16px;flex-wrap:wrap}
.intel-relevance{font-size:11px;font-weight:700;padding:2px 8px;border-radius:10px}
.intel-body{font-size:14px;line-height:1.7}
.intel-insight{margin-top:10px;padding:10px 14px;background:rgba(64,128,240,.06);border-left:3px solid var(--blue);border-radius:0 8px 8px 0;font-size:13px;line-height:1.6;color:var(--text)}

/* Reports */
.report-card{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;transition:all .25s;opacity:1;animation:cardIn .5s forwards}
.report-card:hover{border-color:var(--border-hover);transform:translateY(-2px)}
.report-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.report-title{font-size:15px;font-weight:600}.report-badge{font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px;background:rgba(64,192,128,.15);color:var(--green)}
.report-meta{font-size:12px;color:var(--text2);margin-bottom:8px}
.report-summary{font-size:13px;line-height:1.6;color:var(--text2)}

/* Reading */
.reading-item{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:16px 20px;margin-bottom:10px;display:flex;align-items:center;gap:14px;transition:all .25s;opacity:1;animation:cardIn .4s forwards}
.reading-item:hover{border-color:var(--border-hover)}
.reading-status{font-size:10px;font-weight:700;padding:3px 8px;border-radius:10px;text-transform:uppercase;letter-spacing:.5px;flex-shrink:0}
.reading-status.reading{background:rgba(64,192,128,.15);color:var(--green)}.reading-status.queued{background:rgba(152,152,176,.12);color:var(--text2)}.reading-status.completed{background:rgba(64,128,240,.15);color:var(--blue)}
.reading-title{font-size:14px;font-weight:500;flex:1}
.reading-author{font-size:12px;color:var(--text2)}
.reading-type{font-size:10px;color:var(--text2);padding:2px 6px;background:var(--surface2);border-radius:6px}
.progress-bar{width:80px;height:4px;background:var(--surface3);border-radius:2px;overflow:hidden;flex-shrink:0}
.progress-fill{height:100%;border-radius:2px;background:var(--green)}

/* Outreach */
.outreach-card{background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:12px;transition:all .25s;opacity:1;animation:cardIn .5s forwards}
.outreach-card:hover{border-color:var(--border-hover)}
.outreach-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.outreach-recipient{font-size:14px;font-weight:600}
.outreach-status{font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px}
.outreach-status.ready{background:rgba(64,128,240,.15);color:var(--blue)}.outreach-status.sent{background:rgba(64,192,128,.15);color:var(--green)}
.outreach-subject{font-size:13px;color:var(--text2);margin-bottom:8px}
.outreach-body{font-size:13px;line-height:1.6;padding:12px;background:var(--surface2);border-radius:8px;white-space:pre-line;max-height:120px;overflow:hidden;transition:max-height .3s}
.outreach-body.expanded{max-height:none}
.outreach-context{font-size:12px;color:var(--text2);margin-top:8px;padding:8px 12px;background:rgba(64,128,240,.04);border-radius:6px;border-left:2px solid var(--blue)}

.section-cta{text-align:center;padding:20px;margin-top:24px;font-size:12px;color:var(--text2);opacity:.5}
.section-cta a{color:var(--blue);font-weight:600}

.demo-card{background:linear-gradient(135deg,rgba(64,128,240,.08),rgba(160,96,240,.06));border:1px solid rgba(64,128,240,.2);border-radius:var(--radius);padding:24px;margin-bottom:24px;text-align:center}
.demo-card p{font-size:14px;line-height:1.6;color:var(--text2)}
.demo-card a{color:var(--blue);font-weight:600}

/* Mobile */
.menu-toggle{display:none;position:fixed;top:12px;left:12px;z-index:50;background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:8px 12px;color:var(--text);cursor:pointer;font-size:18px}
.mobile-tabs{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--glass);backdrop-filter:blur(20px);border-top:1px solid var(--glass-border);z-index:40;padding:4px 0;padding-bottom:env(safe-area-inset-bottom,4px)}
.mobile-tabs-inner{display:flex;justify-content:space-around;align-items:center}
.mobile-tab{display:flex;flex-direction:column;align-items:center;gap:2px;padding:6px 8px;border-radius:8px;cursor:pointer;color:var(--text2);font-size:10px;font-weight:500;transition:all .2s;border:none;background:none;font-family:inherit;flex:1}
.mobile-tab svg{width:20px;height:20px}.mobile-tab.active{color:var(--blue)}.mobile-tab:active{transform:scale(.9)}
@media(max-width:1024px){
  body{height:auto;overflow:auto;display:block;-webkit-overflow-scrolling:touch}
  .sidebar{position:fixed;left:-260px;top:0;height:100%;z-index:40;transition:left .3s cubic-bezier(.4,0,.2,1)}
  .sidebar.open{left:0}
  .menu-toggle{display:block}
  .mobile-tabs{display:block}
  .main{padding:20px 16px;padding-top:56px;padding-bottom:80px;overflow:visible;height:auto;min-height:auto}
  .section.active{display:block;overflow:visible}
  .stats-grid{grid-template-columns:1fr 1fr}.agents-grid{grid-template-columns:1fr}
  .filter-bar{flex-direction:column;align-items:stretch}.search-input{width:100%}
  .health-grid{grid-template-columns:1fr 1fr}
  .pipeline-stages{flex-wrap:wrap}
}
@media(min-width:1025px) and (pointer:coarse){
  body{height:auto;overflow:auto;-webkit-overflow-scrolling:touch}
  .main{overflow:visible;height:auto;min-height:auto}
}

/* Kanban Board */
.kanban-board-switcher{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap}
.kanban-board-switcher .kb-tab{padding:7px 16px;border-radius:20px;font-size:12px;font-weight:600;cursor:pointer;border:1px solid var(--border);background:var(--surface);color:var(--text2);transition:all .2s}
.kanban-board-switcher .kb-tab:hover{background:var(--surface2);color:var(--text)}
.kanban-board-switcher .kb-tab.active{color:#fff;border-color:transparent}
.kanban-board-group{margin-bottom:32px}
.kanban-board-group .kb-group-header{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.kanban-board-group .kb-group-dot{width:10px;height:10px;border-radius:50%}
.kanban-board-group .kb-group-name{font-size:16px;font-weight:700}
.kanban-board-group .kb-group-count{font-size:13px;color:var(--text2)}
.kanban-columns{display:flex;gap:14px;overflow-x:auto;padding-bottom:12px;min-height:300px}
.kanban-col{min-width:240px;width:240px;flex-shrink:0;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);display:flex;flex-direction:column;max-height:70vh}
.kanban-col-header{padding:14px 16px 10px;font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:1px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border)}
.kanban-col-header .kc-count{font-size:11px;font-weight:600;background:var(--surface2);padding:2px 8px;border-radius:10px;color:var(--text2)}
.kanban-col-body{flex:1;overflow-y:auto;padding:10px;min-height:60px;transition:background .2s}
.kanban-col-body.drag-over{background:rgba(64,128,240,.08);border-radius:0 0 var(--radius) var(--radius)}
.kanban-card{background:rgba(20,30,46,.7);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid var(--border);border-radius:8px;padding:12px;margin-bottom:8px;cursor:grab;transition:all .2s;user-select:none}
.kanban-card:active{cursor:grabbing}
.kanban-card:hover{border-color:var(--border-hover);box-shadow:0 4px 16px rgba(0,0,0,.3)}
.kanban-card.dragging{opacity:.4;transform:scale(.96)}
.kanban-card.won-glow{box-shadow:0 0 12px rgba(64,192,128,.2);border-color:rgba(64,192,128,.3)}
.kanban-card.lost-dim{opacity:.5}
.kanban-card .kc-company{font-size:14px;font-weight:700;margin-bottom:4px}
.kanban-card .kc-contact{font-size:12px;color:var(--text2);margin-bottom:6px}
.kanban-card .kc-signal{font-size:11px;color:var(--text2);line-height:1.5;margin-bottom:8px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.kanban-card .kc-meta{display:flex;flex-wrap:wrap;gap:4px;align-items:center}
.kanban-card .kc-badge{font-size:10px;font-weight:700;padding:2px 8px;border-radius:10px;color:#fff}
.kanban-card .kc-badge.src-ai{background:#0066FF}
.kanban-card .kc-badge.src-referral{background:#FF6B00}
.kanban-card .kc-badge.src-partner{background:#00A550}
.kanban-card .kc-tag{font-size:10px;padding:2px 7px;border-radius:10px;background:var(--surface2);color:var(--text2)}
.kanban-card .kc-date{font-size:10px;color:var(--text2);margin-left:auto}
.kanban-toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:10px 20px;font-size:13px;color:var(--text);z-index:200;transition:transform .3s cubic-bezier(.4,0,.2,1);pointer-events:none}
.kanban-toast.show{transform:translateX(-50%) translateY(0)}
.kanban-modal{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);z-index:150;display:none;align-items:center;justify-content:center}
.kanban-modal.open{display:flex}
.kanban-modal-content{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:28px;max-width:520px;width:90%;max-height:80vh;overflow-y:auto;animation:cardIn .3s ease}
.kanban-modal-content h2{font-size:18px;font-weight:700;margin-bottom:4px}
.kanban-modal-content .km-contact{font-size:13px;color:var(--text2);margin-bottom:12px}
.kanban-modal-content .km-section{margin-bottom:14px}
.kanban-modal-content .km-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:4px}
.kanban-modal-content .km-text{font-size:13px;line-height:1.6;color:var(--text)}
.kanban-modal-content .km-tags{display:flex;flex-wrap:wrap;gap:4px;margin-top:8px}
@media(max-width:1024px){
  .kanban-columns{flex-direction:column}
  .kanban-col{min-width:100%;width:100%;max-height:none}
}

/* Stocks */
.stocks-table-wrap{overflow-x:auto;margin-top:8px}
.stocks-table{width:100%;border-collapse:collapse;font-size:14px}
.stocks-table th{text-align:left;padding:10px 14px;font-size:11px;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:var(--text2);border-bottom:1px solid var(--border);white-space:nowrap}
.stocks-table td{padding:14px 14px;border-bottom:1px solid var(--border);vertical-align:top}
.stocks-table tr:last-child td{border-bottom:none}
.stocks-table tr.sv-undervalued td{background:rgba(64,192,128,.06)}
.stocks-table tr.sv-midvalued td{background:rgba(240,192,64,.05)}
.stocks-table tr.sv-fullvalued td{background:transparent}
.stock-ticker{font-weight:700;font-size:15px;letter-spacing:.5px}
.stock-name{font-size:11px;color:var(--text2);margin-top:2px}
.stock-yield{font-size:11px;color:var(--green);font-weight:600;margin-top:3px}
.stock-rating{display:inline-block;font-size:10px;font-weight:700;padding:2px 8px;border-radius:10px;letter-spacing:.5px;margin-top:4px}
.stock-rating.buy{background:rgba(64,192,128,.15);color:var(--green)}
.stock-rating.hold{background:rgba(240,192,64,.15);color:var(--yellow)}
.stock-rating.watch{background:rgba(130,130,140,.15);color:var(--text2)}
.stock-rating.strongbuy{background:rgba(64,192,128,.25);color:var(--green)}
.stock-price{font-size:16px;font-weight:600}
.stock-currency{font-size:11px;color:var(--text2)}
.stock-vs-low{font-size:12px;color:var(--text2);margin-top:4px}
.stock-estimate{font-size:14px;font-weight:500}
.stock-thesis-preview{color:var(--text);line-height:1.5;font-size:13px}
.stock-thesis-full{display:none;color:var(--text2);line-height:1.6;font-size:12px;margin-top:6px;padding-top:6px;border-top:1px solid var(--border)}
.stock-thesis-toggle{font-size:11px;color:var(--blue);cursor:pointer;margin-top:4px;display:inline-block;user-select:none}
.stock-risks{font-size:11px;color:var(--text2);margin-top:6px;font-style:italic}
.stock-date{font-size:10px;color:var(--text2);margin-top:4px;opacity:.7}
.stocks-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.stocks-updated{font-size:12px;color:var(--text2)}

/* Travel Research */
.travel-research { margin-top: 16px; }
.research-item { background: var(--surface2); border-radius: 8px; padding: 12px 16px; margin-bottom: 8px; }
.research-status { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 8px; }
.research-status.pending { background: var(--yellow); }
.research-status.complete { background: var(--green); }
.research-input { display: flex; gap: 8px; margin-top: 12px; }
.research-input input { flex: 1; padding: 10px 14px; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 13px; font-family: inherit; }
.research-input button { padding: 10px 18px; background: var(--blue); border: none; border-radius: 8px; color: #fff; font-weight: 600; cursor: pointer; font-size: 13px; }
.kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:28px}
.kpi-label{font-size:12px;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px}
.kpi-value{font-size:28px;font-weight:700;letter-spacing:-.02em}
.kpi-sub{font-size:12px;color:var(--text2);margin-top:4px}
.kpi-up{color:var(--green)}.kpi-down{color:var(--red)}
.proj-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:24px;margin-bottom:16px}
.proj-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}
.proj-name{font-size:17px;font-weight:700}
.proj-meta{font-size:13px;color:var(--text2);margin-top:4px}
.proj-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:16px}
.proj-stat-label{font-size:11px;color:var(--text2);text-transform:uppercase;letter-spacing:.5px}
.proj-stat-value{font-size:16px;font-weight:600;margin-top:4px}
.progress-fill{height:100%;border-radius:3px;transition:width .3s}
.badge-yellow{background:rgba(240,192,64,.15);color:var(--yellow)}
.badge-gray{background:rgba(136,152,176,.12);color:var(--text2)}
.table-wrap{background:var(--glass);border:1px solid var(--glass-border);border-radius:var(--radius);overflow:hidden}
.bar-chart{display:flex;align-items:flex-end;gap:8px;height:120px;padding:0 4px}
.bar-group{display:flex;flex-direction:column;align-items:center;flex:1;gap:2px}
.bar-wrap{display:flex;gap:2px;align-items:flex-end;flex:1;width:100%}
.bar{flex:1;border-radius:3px 3px 0 0;transition:height .3s}
.bar-rev{background:var(--blue);opacity:.8}
.bar-exp{background:var(--red);opacity:.6}
.bar-label{font-size:10px;color:var(--text2);margin-top:4px}
.k-card{background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px;margin-bottom:8px;cursor:pointer;transition:border-color .15s}
.k-card:hover{border-color:var(--blue)}
.k-name{font-size:13px;font-weight:600;margin-bottom:4px}
.k-detail{font-size:11px;color:var(--text2);margin-bottom:6px}
.k-footer{display:flex;justify-content:space-between;align-items:center}
.k-days{font-size:10px;color:var(--text2)}
.k-ai{font-size:9px;font-weight:700;background:rgba(64,128,240,.2);color:var(--blue);padding:2px 6px;border-radius:4px}
.intel-card{background:var(--glass);backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius);padding:20px;margin-bottom:16px}
.intel-ai-label{font-size:11px;font-weight:700;color:var(--blue);text-transform:uppercase;letter-spacing:.6px;margin-bottom:8px}
.cap-bar{height:10px;border-radius:5px;background:var(--surface3);overflow:hidden;display:flex}
.cap-equity{background:var(--blue)}
.cap-debt{background:var(--green)}
.cap-mezz{background:var(--yellow)}
.avatar{width:32px;height:32px;border-radius:50%;background:var(--accent-light);display:inline-flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:var(--blue)}
.kanban-board{display:flex;gap:16px;overflow-x:auto;padding-bottom:16px;min-height:calc(100vh - 280px)}
.kanban-col{flex:1;min-width:240px;max-width:320px;background:var(--surface2);border-radius:var(--radius);display:flex;flex-direction:column}
.kanban-col-header{padding:12px 14px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)}
.kanban-col-title{font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;display:flex;align-items:center;gap:8px}
.kanban-col-count{font-size:11px;font-weight:700;background:var(--border);color:var(--text2);padding:2px 8px;border-radius:10px}
.kanban-col-add{width:26px;height:26px;border-radius:6px;border:1px dashed var(--border);background:transparent;color:var(--text2);font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;line-height:1}
.kanban-col-add:hover{border-color:var(--blue);color:var(--blue)}
.kanban-col-body{flex:1;padding:8px;overflow-y:auto;min-height:80px}
.kanban-col-body.drag-over{background:rgba(64,128,240,.08)}
.kanban-card{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:12px;margin-bottom:8px;cursor:grab;transition:all .15s;box-shadow:0 1px 3px rgba(0,0,0,.2)}
.kanban-card:hover{border-color:var(--border-hover);box-shadow:0 2px 8px rgba(0,0,0,.3)}
.kanban-card.dragging{opacity:.4;transform:rotate(2deg)}
.kanban-card-title{font-size:13px;font-weight:600;line-height:1.4;margin-bottom:8px}
.kanban-card-meta{display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-bottom:6px}
.priority-tag{font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;text-transform:uppercase}
.priority-tag.high{background:rgba(240,64,96,.15);color:var(--red)}
.priority-tag.medium{background:rgba(240,192,64,.15);color:var(--yellow)}
.priority-tag.low{background:rgba(64,192,128,.15);color:var(--green)}
.kanban-card-due{font-size:11px;color:var(--text2)}
.kanban-card-due.overdue{color:var(--red);font-weight:600}
.move-btn{padding:5px 12px;border-radius:6px;border:1px solid var(--border);background:var(--surface2);color:var(--text2);font-size:12px;cursor:pointer;font-family:inherit;transition:all .15s}
.move-btn:hover{background:var(--accent-light);color:#fff;border-color:transparent}
.move-btn.current{background:var(--blue);color:#fff;border-color:transparent}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:300;display:none;align-items:center;justify-content:center}
.modal-overlay.open{display:flex}
.modal-box{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:28px;width:460px;max-width:95vw;max-height:90vh;overflow-y:auto}
.modal-box h2{font-size:17px;font-weight:700;margin-bottom:20px}
.modal-field{margin-bottom:16px}
.modal-field label{display:block;font-size:12px;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.modal-field input,.modal-field textarea,.modal-field select{width:100%;padding:10px 12px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:13px;font-family:inherit;outline:none;transition:border-color .2s}
.modal-field input:focus,.modal-field textarea:focus,.modal-field select:focus{border-color:var(--blue)}
.modal-field textarea{resize:vertical;min-height:80px}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:20px}
.modal-btn{padding:9px 20px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;font-family:inherit;border:none;transition:all .15s}
.modal-btn.primary{background:var(--blue);color:#fff}
.modal-btn.primary:hover{background:#5090ff}
.modal-btn.secondary{background:var(--surface2);color:var(--text2);border:1px solid var(--border)}
.modal-btn.danger{background:rgba(240,64,96,.15);color:var(--red);border:1px solid rgba(240,64,96,.2)}
</style>
</head>
<body>



<button class="menu-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">â˜°</button>

<nav class="sidebar">
  <div class="sidebar-logo">
    <div class="title">MISSION CONTROL</div>
    <span class="sub">Acme Ventures â€” Alex Chen</span>
  </div>
  <div class="nav" id="nav"></div>
  <div class="sidebar-footer"><a href="https://solveworks.io" target="_blank">Powered by SolveWorks</a></div>
</nav>

<div class="main" id="main-content"></div>

<div class="mobile-tabs"><div class="mobile-tabs-inner">
  <button class="mobile-tab active" onclick="showSection('dashboard')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>Home</button>
  <button class="mobile-tab" onclick="showSection('tasks')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/></svg>Tasks</button>
  <button class="mobile-tab" onclick="showSection('meetings')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/></svg>Meetings</button>
  <button class="mobile-tab" onclick="showSection('crm')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/><path d="M9 14l2 2 4-4"/></svg>Pipeline</button>
  <button class="mobile-tab" onclick="showSection('agents')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 10-16 0"/></svg>Agents</button>
</div></div>

<!-- Task Modal -->
<div class="modal-overlay" id="modal-task">
  <div class="modal-box">
    <h2 id="modal-task-title">New Task</h2>
    <div class="modal-field"><label>Title</label><input id="mt-title" type="text" placeholder="Task title..." /></div>
    <div class="modal-field"><label>Description</label><textarea id="mt-desc" placeholder="Optional details..."></textarea></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="modal-field"><label>Priority</label><select id="mt-priority"><option value="high">ðŸ”´ High</option><option value="medium" selected>ðŸŸ¡ Medium</option><option value="low">ðŸŸ¢ Low</option></select></div>
      <div class="modal-field"><label>Due Date</label><input id="mt-due" type="date" /></div>
    </div>
    <div class="modal-field" id="mt-move-section" style="display:none"><label>Move to</label><div id="mt-move-btns" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px"></div></div>
    <div class="modal-actions">
      <button class="modal-btn danger" id="mt-delete" onclick="deleteTask()" style="display:none;margin-right:auto">Delete</button>
      <button class="modal-btn secondary" onclick="closeTaskModal()">Cancel</button>
      <button class="modal-btn primary" id="mt-save" onclick="saveTask()">Create</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="modal-doc" onclick="document.getElementById('modal-doc').style.display='none'">
  <div class="modal-box" style="max-width:500px" onclick="event.stopPropagation()">
    <div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px">
      <div>
        <h2 id="modal-doc-title" style="margin-bottom:4px"></h2>
        <div id="modal-doc-meta" style="font-size:12px;color:var(--text2)"></div>
      </div>
      <button onclick="document.getElementById('modal-doc').style.display='none'" style="background:none;border:none;color:var(--text2);font-size:28px;line-height:1;cursor:pointer;flex-shrink:0;margin-left:16px;padding:4px 8px;-webkit-tap-highlight-color:transparent" aria-label="Close">Ã—</button>
    </div>
    <div id="modal-doc-content" style="font-size:14px;line-height:1.7;color:var(--text2)"></div>
    <div class="modal-actions" style="margin-top:20px">
      <button class="modal-btn primary" onclick="document.getElementById('modal-doc').style.display='none'" style="width:100%;padding:14px;font-size:15px">Close</button>
    </div>
  </div>
</div>

<script>

const SECTIONS=[
  {id:'dashboard',icon:'<rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/>',label:'Dashboard'},
  {id:'activity',icon:'<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>',label:'Activity Feed'},
  {id:'tasks',icon:'<path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>',label:'Tasks',badge:'tasks-badge'},
  {id:'meetings',icon:'<rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>',label:'Meetings',badge:'meetings-badge'},
  {id:'documents',icon:'<path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/>',label:'Documents'},
  {id:'agents',icon:'<circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 10-16 0"/>',label:'Agents'},
  {id:'travel',icon:'<path d="M21 16v-2l-8-5V3.5a1.5 1.5 0 00-3 0V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>',label:'Travel'},
  {id:'health',icon:'<path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/>',label:'Health'},
  {id:'security',icon:'<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>',label:'Security'},
  {id:'calls',icon:'<path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.12.8.36 1.58.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c1.23.34 2.01.58 2.81.7A2 2 0 0122 16.92z"/>',label:'Call Analysis'},
  {id:'crm',icon:'<path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/><path d="M9 14l2 2 4-4"/>',label:'Pipeline',badge:'crm-badge'},
  {id:'email',icon:'<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/>',label:'Email Triage',badge:'email-badge'},
  {id:'intel',icon:'<circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>',label:'Intel'},
  {id:'reports',icon:'<path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/>',label:'Reports'},
  {id:'reading',icon:'<path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/>',label:'Reading List'},
  {id:'outreach',icon:'<line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>',label:'Outreach'},
  {id:'expenses',icon:'<path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1z"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="16" y2="10"/><line x1="8" y1="14" x2="12" y2="14"/>',label:'Expenses',badge:'expenses-badge'},
  {id:'stocks',icon:'<polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/>',label:'Stocks'},
  {id:'projects',icon:'<rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/>',label:'Projects'},
  {id:'financials',icon:'<polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/>',label:'Financials'},
  {id:'inventory',icon:'<path d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"/>',label:'Inventory'},
  {id:'pipeline2',icon:'<rect x="3" y="3" width="4" height="18" rx="1"/><rect x="10" y="3" width="4" height="12" rx="1"/><rect x="17" y="3" width="4" height="15" rx="1"/>',label:'Deal Pipeline',badge:'pipeline2-badge'},
  {id:'market',icon:'<circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 010 20M12 2a15.3 15.3 0 000 20"/>',label:'Market Intel'},
  {id:'permits',icon:'<path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="9" y1="13" x2="15" y2="13"/>',label:'Permits'},
  {id:'contractors',icon:'<path d="M14.7 6.3a1 1 0 010 1.4l-8 8a1 1 0 01-.4.25l-4 1a1 1 0 01-1.2-1.2l1-4a1 1 0 01.25-.4l8-8a1 1 0 011.4 0z"/><path d="M13 8l3 3"/>',label:'Contractors'},
  {id:'investors',icon:'<path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>',label:'Investors'}
];

// Build nav & sections
(function(){
  let navH='',mainH='';
  SECTIONS.forEach((s,i)=>{
    navH+=`<div class="nav-item${i===0?' active':''}" data-section="${s.id}" onclick="showSection('${s.id}')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">${s.icon}</svg>${s.label}${s.badge?`<span class="nav-badge" id="${s.badge}">0</span>`:''}</div>`;
    mainH+=`<div class="section${i===0?' active':''}" id="sec-${s.id}"><div style="padding:40px;text-align:center;color:var(--text2)">Loading...</div></div>`;
  });
  document.getElementById('nav').innerHTML=navH;
  document.getElementById('main-content').innerHTML=mainH;
})();

/* AUTH */
async function sha256(s){const d=new TextEncoder().encode(s);const h=await crypto.subtle.digest('SHA-256',d);return Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('')}


const RENDER_MAP={
  documents:renderDocuments,
  projects:renderProjects,
  financials:renderFinancials,
  inventory:renderInventory,
  pipeline2:renderPipeline2,
  market:renderMarket,
  permits:renderPermits,
  contractors:renderContractors,
  investors:renderInvestors
};
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.querySelectorAll('.mobile-tab').forEach(t=>t.classList.remove('active'));
  const sec=document.getElementById('sec-'+id);
  if(sec){
    // Re-render hardcoded sections on every click â€” zero timing dependency
    if(RENDER_MAP[id]){try{RENDER_MAP[id]()}catch(e){console.error(id+' render error:',e)}}
    sec.style.animation='none';sec.offsetHeight;sec.style.animation='fadeIn .4s cubic-bezier(.4,0,.2,1)';
    sec.classList.add('active');
  }
  document.querySelector(`.nav-item[data-section="${id}"]`)?.classList.add('active');
  document.querySelector('.sidebar').classList.remove('open');
}

function esc(s){if(s==null)return'';const d=document.createElement('div');d.textContent=s;return d.innerHTML}
async function loadJSON(p){try{const r=await fetch(p+'?_='+Date.now());if(!r.ok)return null;return r.json()}catch(e){return null}}
function cta(){return '<div class="section-cta">Powered by <a href="https://solveworks.io" target="_blank">SolveWorks</a> â€” solveworks.io</div>'}

async function init(){
  // Run all hardcoded (synchronous) renders first â€” instant, no waiting
  try{setupKanban()}catch(e){console.error('Tasks error:',e)}
  try{renderDocuments()}catch(e){console.error('Documents error:',e)}
  try{renderProjects()}catch(e){console.error('Projects error:',e)}
  try{renderFinancials()}catch(e){console.error('Financials error:',e)}
  try{renderInventory()}catch(e){console.error('Inventory error:',e)}
  try{renderPipeline2()}catch(e){console.error('Pipeline2 error:',e)}
  try{renderMarket()}catch(e){console.error('Market error:',e)}
  try{renderPermits()}catch(e){console.error('Permits error:',e)}
  try{renderContractors()}catch(e){console.error('Contractors error:',e)}
  try{renderInvestors()}catch(e){console.error('Investors error:',e)}
  // Then run data-fetching renders in parallel
  await Promise.allSettled([
    renderDashboard().catch(e=>console.error('Dashboard error:',e)),
    renderActivity().catch(e=>console.error('Activity error:',e)),
    renderMeetings().catch(e=>console.error('Meetings error:',e)),
    renderAgents().catch(e=>console.error('Agents error:',e)),
    renderTravel().catch(e=>console.error('Travel error:',e)),
    renderHealth().catch(e=>console.error('Health error:',e)),
    renderSecurity().catch(e=>console.error('Security error:',e)),
    renderCalls().catch(e=>console.error('Calls error:',e)),
    renderCRM().catch(e=>console.error('CRM error:',e)),
    renderEmail().catch(e=>console.error('Email error:',e)),
    renderIntel().catch(e=>console.error('Intel error:',e)),
    renderReports().catch(e=>console.error('Reports error:',e)),
    renderReading().catch(e=>console.error('Reading error:',e)),
    renderOutreach().catch(e=>console.error('Outreach error:',e)),
    renderStocks().catch(e=>console.error('Stocks error:',e))
  ]);
}

/* DASHBOARD */
async function renderDashboard(){
  const d=await loadJSON('data/dashboard.json');
  const s=d?.stats||{};
  document.getElementById('sec-dashboard').innerHTML=`
    <h1 class="page-title">Dashboard</h1>
    <div class="clock" id="clock"></div>
    <div class="demo-card"><p>ðŸŽ¯ <strong>This is a live demo.</strong> Your Mission Control is customized to your business. <a href="https://solveworks.io" target="_blank">â†’ Learn more at solveworks.io</a></p></div>
    <div class="mission-statement"><h2>Mission</h2><p>${esc(d?.mission||'')}</p><span class="tag">${esc(d?.missionTag||'')}</span></div>
    <div class="stats-grid">
      <div class="stat-card"><div class="label">In Progress</div><div class="value" style="color:var(--yellow)">${s.tasksInProgress||0}</div></div>
      <div class="stat-card"><div class="label">Completed</div><div class="value" style="color:var(--green)">${s.tasksCompleted||0}</div></div>
      <div class="stat-card"><div class="label">Meetings Today</div><div class="value" style="color:var(--blue)">${s.meetingsToday||0}</div></div>
      <div class="stat-card"><div class="label">Active Agents</div><div class="value" style="color:var(--purple)">${s.activeAgents||0}</div></div>
      <div class="stat-card"><div class="label">Upcoming Trips</div><div class="value" style="color:var(--red)">${s.upcomingTrips||0}</div></div>
      <div class="stat-card"><div class="label">Health Score</div><div class="value" style="color:#40c0c0">${s.healthScore||0}</div></div>
      <div class="stat-card"><div class="label">Pipeline Value</div><div class="value" style="color:#c080f0">${esc(s.pipelineValue||'$0')}</div></div>
    </div>${cta()}`;
  updateClock();setInterval(updateClock,1000);
}
function updateClock(){const el=document.getElementById('clock');if(el)el.textContent=new Date().toLocaleString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit',second:'2-digit'})}

/* ACTIVITY */
async function renderActivity(){
  const d=await loadJSON('data/activity.json');
  const items=d?.activities||[];
  let html='<h1 class="page-title">Activity Feed</h1><p class="page-sub">Real-time log of everything your agents are doing</p>';
  items.forEach((a,i)=>{
    html+=`<div class="feed-item" style="animation-delay:${Math.min(i*50,500)}ms"><div class="feed-header"><span class="feed-icon">${a.icon||'ðŸ“Œ'}</span><span class="feed-date">${esc(a.date)}</span></div><div class="feed-content">${a.content.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>')}</div></div>`;
  });
  document.getElementById('sec-activity').innerHTML=html+cta();
}

/* TASKS */
/* ===== KANBAN TASKS ===== */
const KCOLS=['todo','inprogress','waiting','done'];
const KCOL_LABELS={todo:'To Do',inprogress:'In Progress',waiting:'Waiting',done:'Done'};
const KCOL_ICONS={todo:'ðŸ“‹',inprogress:'ðŸ”„',waiting:'â³',done:'âœ…'};
const DEMO_TASKS=[
  {id:'t1',title:'Review Q1 financial projections',description:'Go through portfolio IRR and cash position with CFO',status:'inprogress',priority:'high',dueDate:'2026-02-26'},
  {id:'t2',title:'Follow up â€” Yuki Tanaka offer (HP-302)',description:'3-day rule â€” reach out if no response',status:'inprogress',priority:'high',dueDate:'2026-02-25'},
  {id:'t3',title:'Schedule site visit for Nathan & Claire Hughes',description:'Very interested in HP-309, toured Tuesday',status:'todo',priority:'medium',dueDate:'2026-02-27'},
  {id:'t4',title:'Westfield Commons â€” budget variance review',description:'Over by $340K â€” need meeting with Summit Dev Group',status:'todo',priority:'high',dueDate:'2026-02-28'},
  {id:'t5',title:'ThermaAir HVAC â€” resolve overdue invoice ($84K)',status:'todo',priority:'high',dueDate:'2026-02-25'},
  {id:'t6',title:'Prepare LP update report for Q1 distributions',status:'waiting',priority:'medium',dueDate:'2026-03-15'},
  {id:'t7',title:'BP-2025-0312 permit follow-up â€” Meridian building',status:'waiting',priority:'medium'},
  {id:'t8',title:'Send offer package to Thompson Capital',status:'todo',priority:'low'},
  {id:'t9',title:'Harrison Group HP-118 closing docs signed',status:'done',priority:'high'},
  {id:'t10',title:'Andrea Fontaine MR-105 deposit received',status:'done',priority:'medium'}
];
let ktasks=[];let editingKTaskId=null;let newKTaskCol='todo';let kDragId=null;

function setupKanban(){
  try{ktasks=JSON.parse(localStorage.getItem('demo-tasks'));if(!Array.isArray(ktasks)||!ktasks.length)ktasks=null}catch(e){ktasks=null}
  if(!ktasks)ktasks=JSON.parse(JSON.stringify(DEMO_TASKS));
  const sec=document.getElementById('sec-tasks');
  sec.innerHTML=`<h1 class="page-title">Tasks</h1><p class="page-sub">Drag cards between columns Â· Click to edit Â· + to add new</p>
  <div class="kanban-board" id="kb-board">${KCOLS.map(c=>`
    <div class="kanban-col" data-col="${c}">
      <div class="kanban-col-header">
        <span class="kanban-col-title">${KCOL_ICONS[c]} ${KCOL_LABELS[c]} <span class="kanban-col-count" id="kcount-${c}">0</span></span>
        <button class="kanban-col-add" onclick="openNewKTask('${c}')">+</button>
      </div>
      <div class="kanban-col-body" id="kcol-${c}"></div>
    </div>`).join('')}
  </div>`;
  document.querySelectorAll('.kanban-col-body').forEach(col=>{
    col.addEventListener('dragover',e=>{e.preventDefault();col.classList.add('drag-over')});
    col.addEventListener('dragleave',()=>col.classList.remove('drag-over'));
    col.addEventListener('drop',e=>{
      e.preventDefault();col.classList.remove('drag-over');
      if(!kDragId)return;
      const newStatus=col.id.replace('kcol-','');
      const t=ktasks.find(x=>x.id===kDragId);
      if(t&&t.status!==newStatus){t.status=newStatus;saveKTasks();renderKanban();}
    });
  });
  renderKanban();
}

function saveKTasks(){localStorage.setItem('demo-tasks',JSON.stringify(ktasks))}
function kGenId(){return 't'+Date.now().toString(36)+Math.random().toString(36).slice(2,5)}
function kFmtDate(d){if(!d)return '';const dt=new Date(d+'T00:00:00');return dt.toLocaleDateString('en-US',{month:'short',day:'numeric'})}
function kOverdue(d){if(!d)return false;return new Date(d)<new Date(new Date().toDateString())}

function renderKanban(){
  KCOLS.forEach(col=>{
    const items=ktasks.filter(t=>t.status===col);
    const el=document.getElementById('kcol-'+col);if(!el)return;
    el.innerHTML=items.map(t=>`
      <div class="kanban-card" draggable="true" data-id="${t.id}" onclick="openEditKTask('${t.id}')"
        ondragstart="kDragStart(event)" ondragend="kDragEnd(event)">
        <div class="kanban-card-title">${esc(t.title)}</div>
        <div class="kanban-card-meta">
          ${t.priority?`<span class="priority-tag ${t.priority}">${t.priority}</span>`:''}
          ${t.dueDate?`<span class="kanban-card-due ${kOverdue(t.dueDate)?'overdue':''}">${kOverdue(t.dueDate)?'âš  ':'ðŸ“… '}${kFmtDate(t.dueDate)}</span>`:''}
        </div>
      </div>`).join('');
    const cnt=document.getElementById('kcount-'+col);if(cnt)cnt.textContent=items.length;
  });
  const active=ktasks.filter(t=>t.status!=='done').length;
  const badge=document.getElementById('tasks-badge');if(badge)badge.textContent=active||'';
}

function kDragStart(e){kDragId=e.currentTarget.dataset.id;e.currentTarget.classList.add('dragging');e.dataTransfer.effectAllowed='move'}
function kDragEnd(e){e.currentTarget.classList.remove('dragging');kDragId=null}

function openNewKTask(col){
  editingKTaskId=null;newKTaskCol=col;
  document.getElementById('modal-task-title').textContent='New Task';
  document.getElementById('mt-title').value='';
  document.getElementById('mt-desc').value='';
  document.getElementById('mt-due').value='';
  document.getElementById('mt-priority').value='medium';
  document.getElementById('mt-move-section').style.display='none';
  document.getElementById('mt-delete').style.display='none';
  document.getElementById('mt-save').textContent='Create';
  document.getElementById('modal-task').classList.add('open');
  setTimeout(()=>document.getElementById('mt-title').focus(),100);
}

function openEditKTask(id){
  const t=ktasks.find(x=>x.id===id);if(!t)return;
  editingKTaskId=id;
  document.getElementById('modal-task-title').textContent='Edit Task';
  document.getElementById('mt-title').value=t.title||'';
  document.getElementById('mt-desc').value=t.description||'';
  document.getElementById('mt-due').value=t.dueDate||'';
  document.getElementById('mt-priority').value=t.priority||'medium';
  document.getElementById('mt-move-section').style.display='block';
  document.getElementById('mt-move-btns').innerHTML=KCOLS.map(c=>
    `<button class="move-btn ${t.status===c?'current':''}" onclick="moveKTask('${id}','${c}')">${KCOL_ICONS[c]} ${KCOL_LABELS[c]}</button>`
  ).join('');
  document.getElementById('mt-delete').style.display='inline-block';
  document.getElementById('mt-save').textContent='Save';
  document.getElementById('modal-task').classList.add('open');
}

function closeTaskModal(){document.getElementById('modal-task').classList.remove('open')}
function closeDocModal(){const el=document.getElementById('modal-doc');el.classList.remove('open');el.style.display='';}
document.addEventListener('keydown',e=>{
  if(e.key==='Escape'){
    closeTaskModal();
    closeDocModal();
  }
});

function viewDoc(title,type,category,date,size){
  try{
  const iconMap={pdf:'ðŸ“„',xlsx:'ðŸ“Š',pptx:'ðŸ“½ï¸',zip:'ðŸ—‚ï¸'};
  const icon=iconMap[type]||'ðŸ“„';
  const previewMap={
    pdf:'<div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:24px;text-align:center"><div style="font-size:48px;margin-bottom:12px">'+icon+'</div><div style="font-size:14px;color:var(--text);font-weight:500">'+esc(title)+'</div><div style="font-size:12px;color:var(--text2);margin-top:6px">PDF â€¢ '+esc(size)+'</div><div style="margin-top:16px;padding:12px;background:rgba(64,128,240,.08);border-radius:8px;font-size:12px;color:var(--blue)">Preview requires shared file access</div></div>',
    xlsx:'<div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:24px;text-align:center"><div style="font-size:48px;margin-bottom:12px">'+icon+'</div><div style="font-size:14px;color:var(--text);font-weight:500">'+esc(title)+'</div><div style="font-size:12px;color:var(--text2);margin-top:6px">Spreadsheet â€¢ '+esc(size)+'</div><div style="margin-top:16px;padding:12px;background:rgba(64,128,240,.08);border-radius:8px;font-size:12px;color:var(--blue)">Open in Excel or Google Sheets</div></div>',
    pptx:'<div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:24px;text-align:center"><div style="font-size:48px;margin-bottom:12px">'+icon+'</div><div style="font-size:14px;color:var(--text);font-weight:500">'+esc(title)+'</div><div style="font-size:12px;color:var(--text2);margin-top:6px">Presentation â€¢ '+esc(size)+'</div><div style="margin-top:16px;padding:12px;background:rgba(64,128,240,.08);border-radius:8px;font-size:12px;color:var(--blue)">Open in PowerPoint or Google Slides</div></div>',
    zip:'<div style="background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:24px;text-align:center"><div style="font-size:48px;margin-bottom:12px">'+icon+'</div><div style="font-size:14px;color:var(--text);font-weight:500">'+esc(title)+'</div><div style="font-size:12px;color:var(--text2);margin-top:6px">Archive â€¢ '+esc(size)+'</div><div style="margin-top:16px;padding:12px;background:rgba(64,128,240,.08);border-radius:8px;font-size:12px;color:var(--blue)">Download to access files</div></div>'
  };
  document.getElementById('modal-doc-title').textContent=title;
  document.getElementById('modal-doc-meta').textContent=category+' Â· '+date+' Â· '+size;
  document.getElementById('modal-doc-content').innerHTML=previewMap[type]||previewMap.pdf;
  const el=document.getElementById('modal-doc');
  el.style.display='flex';
  el.classList.add('open');
  }catch(e){console.error('viewDoc error:',e);alert('Could not open document: '+e.message);}
}
window.viewDoc=viewDoc;

function moveKTask(id,col){
  const t=ktasks.find(x=>x.id===id);if(!t)return;
  t.status=col;saveKTasks();renderKanban();
  document.getElementById('mt-move-btns').innerHTML=KCOLS.map(c=>
    `<button class="move-btn ${t.status===c?'current':''}" onclick="moveKTask('${id}','${c}')">${KCOL_ICONS[c]} ${KCOL_LABELS[c]}</button>`
  ).join('');
}

function saveTask(){
  const title=document.getElementById('mt-title').value.trim();
  if(!title)return;
  if(editingKTaskId){
    const t=ktasks.find(x=>x.id===editingKTaskId);if(!t)return;
    t.title=title;t.description=document.getElementById('mt-desc').value.trim();
    t.priority=document.getElementById('mt-priority').value;t.dueDate=document.getElementById('mt-due').value;
  } else {
    ktasks.push({id:kGenId(),title,description:document.getElementById('mt-desc').value.trim(),
      status:newKTaskCol,priority:document.getElementById('mt-priority').value,dueDate:document.getElementById('mt-due').value});
  }
  saveKTasks();renderKanban();closeTaskModal();
}

function deleteTask(){
  if(!editingKTaskId)return;
  ktasks=ktasks.filter(t=>t.id!==editingKTaskId);
  saveKTasks();renderKanban();closeTaskModal();
}

/* MEETINGS */
async function renderMeetings(){
  const d=await loadJSON('data/meetings.json');
  const meetings=d?.meetings||[];
  const todayStr=new Date().toISOString().slice(0,10);
  const badge=document.getElementById('meetings-badge');
  const now=new Date();
  const upcomingCount=meetings.filter(m=>new Date(m.datetime)>=now||m.datetime?.slice(0,10)===todayStr).length;
  if(badge)badge.textContent=upcomingCount;
  let html='<h1 class="page-title">Meetings</h1><p class="page-sub">Upcoming meetings with AI-powered prep</p>';
  meetings.forEach((m,i)=>{
    const isToday=m.datetime?.slice(0,10)===todayStr;
    const dt=new Date(m.datetime);
    const timeStr=dt.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'});
    const dateStr=dt.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'});
    html+=`<div class="meeting-card ${isToday?'today':''}" style="animation-delay:${i*60}ms" onclick="this.classList.toggle('expanded')">
      <div class="meeting-header"><div><div class="meeting-title">${esc(m.title)}</div><div class="meeting-meta"><span>ðŸ“… ${dateStr} at ${timeStr}</span><span>â± ${esc(m.duration)}</span><span>ðŸ“ ${esc(m.location)}</span></div>
      <div class="meeting-attendees">${(m.attendees||[]).map(a=>`<span class="meeting-attendee">${esc(a)}</span>`).join('')}</div></div>
      <span class="meeting-badge ${isToday?'today-badge':'upcoming-badge'}">${isToday?'Today':'Upcoming'}</span></div>
      <div class="meeting-details"><div class="meeting-prep"><h4>AI Prep Requests</h4>
      ${(m.prepRequests||[]).map(p=>`<div class="prep-item"><span class="prep-dot ${p.status}"></span><div><div>${esc(p.text)}</div>${p.response?`<div class="prep-response">âœ… ${esc(p.response)}</div>`:p.status==='pending'?'<div class="prep-response" style="color:var(--yellow)">â³ Pending...</div>':''}</div></div>`).join('')}
      <div class="prep-input-wrap"><input class="prep-input" placeholder="Add a prep request..." onclick="event.stopPropagation()"><button class="prep-submit" onclick="event.stopPropagation()">Request</button></div>
      </div></div></div>`;
  });
  document.getElementById('sec-meetings').innerHTML=html+cta();
}

/* DOCUMENTS */
function renderDocuments(){
  const docs=[
    {title:'Brand Identity Guide 2026',type:'pdf',category:'Brand',date:'Jan 15, 2026',size:'18.4 MB'},
    {title:'Logo Package â€” All Formats',type:'zip',category:'Brand',date:'Jan 15, 2026',size:'42.1 MB'},
    {title:'Color Palette & Typography',type:'pdf',category:'Brand',date:'Jan 15, 2026',size:'2.8 MB'},
    {title:'Brand Voice & Messaging Guide',type:'pdf',category:'Brand',date:'Feb 3, 2026',size:'1.4 MB'},
    {title:'Social Media Templates',type:'zip',category:'Brand',date:'Feb 10, 2026',size:'24.6 MB'},
    {title:'Series B Pitch Deck v3.2',type:'pdf',category:'Strategy',date:'Feb 20, 2026',size:'4.2 MB'},
    {title:'Board Meeting Minutes â€” Jan',type:'pdf',category:'Strategy',date:'Jan 28, 2026',size:'340 KB'},
    {title:'Q1 2026 Financial Model',type:'xlsx',category:'Finance',date:'Feb 18, 2026',size:'1.8 MB'},
    {title:'Competitive Landscape Report',type:'pdf',category:'Research',date:'Feb 21, 2026',size:'2.1 MB'},
    {title:'Product Roadmap Q2â€“Q4',type:'pptx',category:'Product',date:'Feb 15, 2026',size:'6.4 MB'},
    {title:'Employee Onboarding SOP',type:'pdf',category:'Operations',date:'Jan 30, 2026',size:'890 KB'},
    {title:'Customer Success Playbook',type:'pdf',category:'Operations',date:'Feb 10, 2026',size:'1.2 MB'},
    {title:'Marketing Campaign Analytics',type:'xlsx',category:'Marketing',date:'Feb 19, 2026',size:'2.4 MB'},
    {title:'Partnership Agreement Template',type:'pdf',category:'Legal',date:'Feb 12, 2026',size:'560 KB'}
  ];
  // Store docs in global map so event delegation can look them up by index
  window._docs = docs;
  const iconMap={pdf:'ðŸ“„',xlsx:'ðŸ“Š',pptx:'ðŸ“½ï¸',zip:'ðŸ—‚ï¸'};
  const catIcons={'Brand':'ðŸŽ¨','Strategy':'ðŸŽ¯','Finance':'ðŸ’°','Research':'ðŸ”','Product':'ðŸš€','Operations':'âš™ï¸','Marketing':'ðŸ“£','Legal':'âš–ï¸','Engineering':'ðŸ”§'};
  const cats={};
  docs.forEach((d,idx)=>{d._idx=idx;if(!cats[d.category])cats[d.category]=[];cats[d.category].push(d)});
  let html='<h1 class="page-title">Documents</h1><p class="page-sub">All your files, organized by category â€” click any file to preview</p>';
  let i=0;
  Object.entries(cats).forEach(([cat,items])=>{
    html+=`<div style="margin-bottom:24px"><div style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;display:flex;align-items:center;gap:8px">${catIcons[cat]||'ðŸ“'} ${cat} <span style="background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:1px 8px;font-size:10px">${items.length}</span></div>`;
    items.forEach(doc=>{
      html+=`<div class="doc-card" data-doc-idx="${doc._idx}" style="animation-delay:${Math.min(i*30,300)}ms"><div class="doc-icon ${doc.type}">${iconMap[doc.type]||'ðŸ“„'}</div><div class="doc-title">${esc(doc.title)}</div><span class="doc-date">${esc(doc.date)}</span><span class="doc-size">${esc(doc.size)}</span></div>`;
      i++;
    });
    html+='</div>';
  });
  const sec=document.getElementById('sec-documents');
  sec.innerHTML=html+cta();
  // Event delegation â€” one listener on the section, no inline onclick needed
  sec.addEventListener('click',function(e){
    const card=e.target.closest('[data-doc-idx]');
    if(!card)return;
    const doc=window._docs[parseInt(card.dataset.docIdx,10)];
    if(doc)viewDoc(doc.title,doc.type,doc.category,doc.date,doc.size);
  });
}

/* AGENTS */
async function renderAgents(){
  const d=await loadJSON('data/agents.json');
  const agents=d?.agents||[];
  let html='<h1 class="page-title">Agents</h1><p class="page-sub">Your AI team â€” always working, always learning</p><div class="agents-grid">';
  agents.forEach(a=>{
    html+=`<div class="agent-card"><span class="agent-status ${a.status}">${a.status}</span><div class="agent-name">${esc(a.name)}</div><div class="agent-role">${esc(a.role)}</div><div class="agent-desc">${esc(a.description)}</div><div class="agent-meta"><span>ðŸ”§ ${a.taskCount} active tasks</span><span>â± ${esc(a.lastActive)}</span></div><div class="agent-caps">${(a.capabilities||[]).map(c=>`<span class="agent-cap">${esc(c)}</span>`).join('')}</div></div>`;
  });
  document.getElementById('sec-agents').innerHTML=html+'</div>'+cta();
}

/* TRAVEL */
function showToast(msg){const t=document.createElement('div');t.textContent=msg;Object.assign(t.style,{position:'fixed',bottom:'24px',left:'50%',transform:'translateX(-50%)',background:'var(--surface2)',color:'var(--text)',padding:'12px 24px',borderRadius:'12px',fontSize:'14px',fontWeight:'500',zIndex:'9999',boxShadow:'0 4px 20px rgba(0,0,0,0.3)',opacity:'0',transition:'opacity 0.3s'});document.body.appendChild(t);requestAnimationFrame(()=>t.style.opacity='1');setTimeout(()=>{t.style.opacity='0';setTimeout(()=>t.remove(),300)},2500)}
async function renderTravel(){
  const d=await loadJSON('data/travel.json');
  const trips=d?.trips||[];
  let html='<h1 class="page-title">Travel</h1><p class="page-sub">Upcoming and past trips with full itineraries</p>';
  trips.forEach((t,ti)=>{
    html+=`<div class="travel-card" style="animation-delay:${ti*80}ms"><div class="travel-card-header" onclick="this.nextElementSibling.classList.toggle('open')"><div><div class="travel-dest">${esc(t.destination)}</div><div class="travel-dates">${esc(t.dates)} â€” ${esc(t.purpose)}</div></div><div><span class="travel-badge business">${esc(t.type)}</span><span class="travel-status ${t.status}">${t.status}</span></div></div><div class="travel-details">`;
    // Flights
    if(t.flights?.length){
      html+=`<div class="travel-section"><div class="travel-section-title">âœˆï¸ Flights</div>`;
      t.flights.forEach(f=>{
        html+=`<div class="flight-route"><div><div class="flight-airport">${esc(f.from)}</div><div class="flight-time">${esc(f.depart)}</div></div><div class="flight-arrow"><div class="flight-num">${esc(f.airline)} ${esc(f.flight)}</div><div class="line"></div></div><div><div class="flight-airport">${esc(f.to)}</div><div class="flight-time">${esc(f.arrive)}</div></div></div><div class="flight-conf">Confirmation: ${esc(f.conf)}</div>`;
      });
      html+=`</div>`;
    }
    // Hotels
    if(t.hotels?.length){
      html+=`<div class="travel-section"><div class="travel-section-title">ðŸ¨ Hotels</div>`;
      t.hotels.forEach(h=>{
        html+=`<div class="hotel-card"><div class="hotel-name">${esc(h.name)}</div><div class="hotel-detail">${esc(h.dates)} â€¢ Conf: ${esc(h.conf)}</div><div class="hotel-detail">${esc(h.address)}</div>${h.notes?`<div class="hotel-detail" style="color:var(--text);margin-top:4px">${esc(h.notes)}</div>`:''}</div>`;
      });
      html+=`</div>`;
    }
    // Itinerary
    if(t.itinerary?.length){
      html+=`<div class="travel-section"><div class="travel-section-title">ðŸ“‹ Itinerary</div>`;
      t.itinerary.forEach(day=>{
        html+=`<div class="itin-day"><div class="itin-date">${esc(day.date)}</div>${(day.items||[]).map(item=>`<div class="itin-item">${esc(item)}</div>`).join('')}</div>`;
      });
      html+=`</div>`;
    }
    // ðŸ” Trip Research
    {
      html+=`<div class="travel-section travel-research"><div class="travel-section-title">ðŸ” Trip Research</div>`;
      const tripId=(t.destination||'').replace(/[^a-zA-Z0-9]/g,'_');
      const stored=JSON.parse(localStorage.getItem('travel_research_'+tripId)||'[]');
      const allResearch=[...(t.research||[]),...stored];
      allResearch.forEach(r=>{
        const resp=r.response?(r.response.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>').replace(/\n/g,'<br>')):'';
        html+=`<div class="research-item"><div><span class="research-status ${r.status}"></span><strong>${esc(r.request)}</strong></div>${resp?`<div style="margin-top:8px;font-size:13px;color:var(--text2)">${resp}</div>`:`<div style="margin-top:4px;font-size:12px;color:var(--text2)">Pending â€” your agent is working on this</div>`}</div>`;
      });
      // TODO: Wire to agent API for actual research execution
      html+=`<div class="research-input"><input type="text" placeholder="What do you want to research for this trip?" onkeydown="if(event.key==='Enter')this.nextElementSibling.click()"><button onclick="const inp=this.previousElementSibling;if(!inp.value.trim())return;const tid='${tripId}';const s=JSON.parse(localStorage.getItem('travel_research_'+tid)||'[]');s.push({request:inp.value.trim(),status:'pending',response:''});localStorage.setItem('travel_research_'+tid,JSON.stringify(s));inp.value='';showToast('Research request submitted');renderTravel()">Request</button></div>`;
      html+=`</div>`;
    }
    // Weather & Notes
    if(t.weather)html+=`<div class="travel-section"><div class="travel-section-title">ðŸŒ¤ Weather</div><div class="travel-notes">${esc(t.weather)}</div></div>`;
    if(t.notes)html+=`<div class="travel-section"><div class="travel-section-title">ðŸ“ Notes</div><div class="travel-notes">${esc(t.notes)}</div></div>`;
    html+=`</div></div>`;
  });
  document.getElementById('sec-travel').innerHTML=html+cta();
}

/* HEALTH */
async function renderHealth(){
  const d=await loadJSON('data/health.json');
  if(!d){document.getElementById('sec-health').innerHTML='<p>No health data</p>';return}
  const t=d.today,sb=d.sleepBreakdown,wk=d.weeklyTrend,act=d.activitySummary;
  let html='<h1 class="page-title">Health</h1><p class="page-sub">Oura Ring data â€” sleep, readiness, and activity</p>';
  html+=`<div class="health-grid">
    <div class="health-card" style="animation-delay:.05s"><div class="h-label">Sleep Score</div><div class="h-value" style="color:var(--blue)">${t.sleepScore}</div><div class="h-sub">Total: ${sb.total} (${sb.bedtime} â†’ ${sb.wakeTime})</div></div>
    <div class="health-card" style="animation-delay:.1s"><div class="h-label">Readiness</div><div class="h-value" style="color:var(--green)">${t.readiness}</div><div class="h-sub">Body temp: ${t.bodyTemp} (${t.bodyTempStatus})</div></div>
    <div class="health-card" style="animation-delay:.15s"><div class="h-label">HRV</div><div class="h-value" style="color:var(--purple)">${t.hrv}<span style="font-size:14px;color:var(--text2)"> ms</span></div><div class="h-sub">Resting HR: ${t.restingHR} bpm</div></div>
    <div class="health-card" style="animation-delay:.2s"><div class="h-label">Activity</div><div class="h-value" style="color:var(--yellow)">${t.steps.toLocaleString()}</div><div class="h-sub">${t.activeMinutes} active min â€¢ ${t.calories} cal</div></div>
  </div>`;
  // Sleep breakdown bar
  html+=`<div class="glass-card" style="padding:20px;margin-bottom:20px"><h3 style="font-size:14px;font-weight:600;margin-bottom:12px">Sleep Breakdown</h3><div class="sleep-breakdown"><div class="sleep-segment" style="width:${sb.deepPct}%;background:#4060d0" title="Deep ${sb.deep}">Deep ${sb.deepPct}%</div><div class="sleep-segment" style="width:${sb.remPct}%;background:#8040c0" title="REM ${sb.rem}">REM ${sb.remPct}%</div><div class="sleep-segment" style="width:${sb.lightPct}%;background:#4080a0" title="Light ${sb.light}">Light ${sb.lightPct}%</div><div class="sleep-segment" style="width:${sb.awakePct}%;background:var(--surface3)" title="Awake ${sb.awake}">Awake</div></div><div style="display:flex;gap:16px;margin-top:8px;font-size:12px;color:var(--text2)"><span>ðŸŸ¦ Deep: ${sb.deep}</span><span>ðŸŸª REM: ${sb.rem}</span><span>Light: ${sb.light}</span><span>Awake: ${sb.awake}</span></div></div>`;
  // 7-day trend
  html+=`<div class="glass-card" style="padding:20px;margin-bottom:20px"><h3 style="font-size:14px;font-weight:600;margin-bottom:12px">7-Day Sleep Score Trend</h3><div class="bar-chart">${wk.sleep.map((v,i)=>`<div class="bar" style="height:${v}%;background:linear-gradient(180deg,var(--blue),rgba(64,128,240,.3))"><span class="bar-label">${wk.days[i]}</span></div>`).join('')}</div></div>`;
  // Activity
  html+=`<div class="glass-card" style="padding:20px;margin-bottom:20px"><h3 style="font-size:14px;font-weight:600;margin-bottom:12px">Weekly Steps</h3><div class="bar-chart">${act.weeklySteps.map((v,i)=>{const pct=Math.round(v/12000*100);return`<div class="bar" style="height:${pct}%;background:linear-gradient(180deg,var(--green),rgba(64,192,128,.3))"><span class="bar-label">${wk.days[i]}</span></div>`}).join('')}</div><div style="margin-top:24px;font-size:12px;color:var(--text2)">ðŸ”¥ ${act.streak}-day activity streak â€¢ Goal: ${act.goal.toLocaleString()} steps/day</div></div>`;
  document.getElementById('sec-health').innerHTML=html+cta();
}

/* SECURITY */
async function renderSecurity(){
  const d=await loadJSON('data/security.json');
  const o=d?.overview||{};
  let html=`<h1 class="page-title">Security</h1><p class="page-sub">System health, audits, and alerts</p>`;
  html+=`<div class="glass-card" style="padding:24px;margin-bottom:20px"><div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap"><span class="security-status-badge ok">âœ… System Healthy</span><span style="font-size:13px;color:var(--text2)">Gateway: <strong style="color:var(--green)">${esc(o.gatewayStatus)}</strong></span><span style="font-size:13px;color:var(--text2)">Uptime: <strong>${esc(o.uptime)}</strong></span><span style="font-size:13px;color:var(--text2)">Last Audit: ${esc(o.lastAudit)}</span></div>
  <div class="stats-grid" style="margin-top:16px;margin-bottom:0"><div class="stat-card" style="animation:none;opacity:1"><div class="label">Critical</div><div class="value" style="color:var(--green)">${o.critical}</div></div><div class="stat-card" style="animation:none;opacity:1"><div class="label">Warnings</div><div class="value" style="color:var(--yellow)">${o.warnings}</div></div><div class="stat-card" style="animation:none;opacity:1"><div class="label">Info</div><div class="value" style="color:var(--blue)">${o.info}</div></div></div></div>`;
  (d?.items||[]).forEach(item=>{
    const lc=item.level==='warning'?'warn':'ok';
    html+=`<div class="security-card"><span class="security-status-badge ${lc}">${item.level==='warning'?'âš ï¸':'â„¹ï¸'} ${item.level.toUpperCase()}</span><div style="font-size:15px;font-weight:600;margin-bottom:6px">${esc(item.title)}</div><div style="font-size:13px;color:var(--text2);line-height:1.6">${esc(item.detail)}</div><div style="font-size:11px;color:var(--text2);margin-top:6px">${esc(item.timestamp)}</div></div>`;
  });
  document.getElementById('sec-security').innerHTML=html+cta();
}

/* CALLS */
async function renderCalls(){
  const d=await loadJSON('data/call-analyses.json');
  const calls=d?.calls||[];
  let html='<h1 class="page-title">Call Analysis</h1><p class="page-sub">AI-analyzed calls with Sandler methodology scoring</p>';
  calls.forEach((c,i)=>{
    const color=c.sandlerScore>=75?'var(--green)':c.sandlerScore>=60?'var(--yellow)':'var(--red)';
    html+=`<div class="call-item" style="animation-delay:${i*80}ms"><div class="call-header"><span class="call-title">${esc(c.title)}</span><span class="call-badge ${c.badge}">${esc(c.badge)}</span><span class="call-date">${esc(c.date)} â€¢ ${esc(c.duration)}</span></div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:8px">${esc(c.prospect)} â€” ${esc(c.company)}</div>
    <div class="sandler-score"><span class="sandler-label">Sandler Score</span><div class="sandler-bar"><div class="sandler-fill" style="width:${c.sandlerScore}%;background:${color}"></div></div><span style="font-size:14px;font-weight:700;color:${color}">${c.sandlerScore}/100</span></div>
    <ul class="call-takeaways">${(c.takeaways||[]).map(t=>`<li>${esc(t)}</li>`).join('')}</ul>
    <div style="margin-top:10px;font-size:13px;color:var(--blue);font-weight:500">ðŸ“‹ Next: ${esc(c.nextSteps)}</div></div>`;
  });
  document.getElementById('sec-calls').innerHTML=html+cta();
}

/* CRM / KANBAN PIPELINE */
async function renderCRM(){
  const leadsData=await loadJSON('data/leads.json');
  const stages=[
    {id:'new',label:'New Leads',color:'var(--blue)'},
    {id:'contacted',label:'Contacted',color:'var(--yellow)'},
    {id:'call-booked',label:'Call Booked',color:'var(--green)'},
    {id:'won',label:'Won',color:'#40c080'},
    {id:'lost',label:'Lost / Dead',color:'var(--text2)'}
  ];
  const stageOverrides=JSON.parse(localStorage.getItem('demo-kanban-stages')||'{}');
  window._kanbanFilter='all';
  window._kanbanLeadMap={};
  if(leadsData&&leadsData.boards)leadsData.boards.forEach(b=>(b.leads||[]).forEach(l=>{window._kanbanLeadMap[b.id+'::'+l.id]=l}));

  function getStage(bid,lid,orig){return stageOverrides[bid+'::'+lid]||orig}
  function setStage(bid,lid,s){stageOverrides[bid+'::'+lid]=s;localStorage.setItem('demo-kanban-stages',JSON.stringify(stageOverrides))}
  function srcClass(s){if(s==='AI Scan')return'src-ai';if(s==='Referral')return'src-referral';return'src-partner'}
  function kanbanToast(msg){const t=document.getElementById('kanban-toast');if(!t)return;t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2200)}
  function openLeadModal(lead){
    const m=document.getElementById('kanban-modal-body');
    m.innerHTML=`<h2>${esc(lead.company)}</h2>
      <div class="km-contact">${esc(lead.contact)}${lead.title?' â€” '+esc(lead.title):''}${lead.email?' Â· '+esc(lead.email):''}</div>
      <div class="km-section"><div class="km-label">Signal</div><div class="km-text">${esc(lead.signal||'â€”')}</div></div>
      <div class="km-section"><div class="km-label">Notes</div><div class="km-text">${esc(lead.notes||'â€”')}</div></div>
      ${lead.meetingDate?`<div class="km-section"><div class="km-label">Meeting</div><div class="km-text">ðŸ“… ${esc(lead.meetingDate)}</div></div>`:''}
      <div class="km-section"><div class="km-label">Added</div><div class="km-text">${esc(lead.added||'â€”')}</div></div>
      ${lead.tags&&lead.tags.length?`<div class="km-tags">${lead.tags.map(t=>`<span class="kc-tag">${esc(t)}</span>`).join('')}</div>`:''}`;
    document.getElementById('kanban-modal').classList.add('open');
  }
  window._openLeadModal=openLeadModal;

  function renderBoard(){
    if(!leadsData||!leadsData.boards)return;
    const boards=window._kanbanFilter==='all'?leadsData.boards:leadsData.boards.filter(b=>b.id===window._kanbanFilter);
    let totalActive=0;
    let sw=`<div class="kb-tab ${window._kanbanFilter==='all'?'active':''}" style="${window._kanbanFilter==='all'?'background:var(--accent-light);':''}" onclick="window._kanbanFilter='all';window._renderBoard()">All Boards</div>`+
      leadsData.boards.map(b=>`<div class="kb-tab ${window._kanbanFilter===b.id?'active':''}" style="${window._kanbanFilter===b.id?'background:'+b.color+';':''}" onclick="window._kanbanFilter='${b.id}';window._renderBoard()">${esc(b.name)}</div>`).join('');
    let html=`<h1 class="page-title">Lead Pipeline</h1><p class="page-sub">The CRM that fills itself â€” drag leads between stages Â· click to expand</p>
      <div class="kanban-board-switcher">${sw}</div>`;
    boards.forEach(board=>{
      const leads=board.leads||[];
      const active=leads.filter(l=>{const s=getStage(board.id,l.id,l.stage);return s!=='won'&&s!=='lost'});
      totalActive+=active.length;
      html+=`<div class="kanban-board-group"><div class="kb-group-header"><div class="kb-group-dot" style="background:${esc(board.color)}"></div><span class="kb-group-name">${esc(board.name)}</span><span class="kb-group-count">(${leads.length} leads)</span></div><div class="kanban-columns">`;
      stages.forEach(st=>{
        const colLeads=leads.filter(l=>getStage(board.id,l.id,l.stage)===st.id);
        html+=`<div class="kanban-col"><div class="kanban-col-header" style="color:${st.color}">${st.label} <span class="kc-count">${colLeads.length}</span></div><div class="kanban-col-body" data-stage="${st.id}" data-board="${board.id}" ondragover="event.preventDefault();this.classList.add('drag-over')" ondragleave="this.classList.remove('drag-over')" ondrop="window._handleDrop(event,this)">`;
        colLeads.forEach(lead=>{
          const extra=st.id==='won'?' won-glow':st.id==='lost'?' lost-dim':'';
          html+=`<div class="kanban-card${extra}" draggable="true" data-id="${esc(lead.id)}" data-board="${esc(board.id)}" data-company="${esc(lead.company)}" ondragstart="window._dragCard(event)" onclick="window._openLeadModal(window._kanbanLeadMap['${board.id}::${lead.id}'])">
            <div class="kc-company">${esc(lead.company)}</div>
            <div class="kc-contact">${esc(lead.contact)}${lead.title?' Â· '+esc(lead.title):''}</div>
            <div class="kc-signal">${esc(lead.signal||'')}</div>
            <div class="kc-meta">
              <span class="kc-badge ${srcClass(lead.source)}">${esc(lead.source)}</span>
              ${(lead.tags||[]).slice(0,2).map(t=>`<span class="kc-tag">${esc(t)}</span>`).join('')}
              ${lead.meetingDate?`<span class="kc-date">ðŸ“… ${esc(lead.meetingDate)}</span>`:`<span class="kc-date">${esc(lead.added||'')}</span>`}
            </div></div>`;
        });
        html+=`</div></div>`;
      });
      html+=`</div></div>`;
    });
    html+=`<div id="kanban-toast" class="kanban-toast"></div><div id="kanban-modal" class="kanban-modal" onclick="if(event.target===this)this.classList.remove('open')"><div class="kanban-modal-content" id="kanban-modal-body"></div></div>`;
    const badge=document.getElementById('crm-badge');if(badge){badge.textContent=totalActive}
    document.getElementById('sec-crm').innerHTML=html+cta();
  }
  window._renderBoard=renderBoard;
  window._dragData={};
  window._dragCard=function(e){const c=e.target.closest('.kanban-card');window._dragData={id:c.dataset.id,board:c.dataset.board,company:c.dataset.company};c.classList.add('dragging');e.dataTransfer.effectAllowed='move'};
  window._handleDrop=function(e,col){e.preventDefault();col.classList.remove('drag-over');const d=window._dragData;if(!d.id)return;const newStage=col.dataset.stage;const board=col.dataset.board;if(d.board!==board)return;setStage(board,d.id,newStage);const labels={new:'New Leads',contacted:'Contacted','call-booked':'Call Booked',won:'Won',lost:'Lost'};kanbanToast('Moved '+d.company+' â†’ '+labels[newStage]);document.querySelectorAll('.kanban-card.dragging').forEach(c=>c.classList.remove('dragging'));renderBoard()};
  renderBoard();
}

/* EMAIL */
async function renderEmail(){
  const d=await loadJSON('data/email-triage.json');
  const emails=d?.emails||[];
  const urgentCount=emails.filter(e=>e.category==='urgent'||e.category==='needs-response').length;
  const badge=document.getElementById('email-badge');if(badge)badge.textContent=urgentCount;
  let html='<h1 class="page-title">Email Triage</h1><p class="page-sub">AI-categorized inbox with suggested actions</p>';
  emails.forEach((e,i)=>{
    html+=`<div class="email-card" style="animation-delay:${i*40}ms"><div class="email-header"><span class="email-from">${esc(e.from)}</span><span class="email-cat ${e.category}">${e.category.replace('-',' ')}</span><span class="email-time">${esc(e.time)}</span></div><div class="email-subject">${esc(e.subject)}</div><div class="email-preview">${esc(e.preview)}</div><div class="email-action">ðŸ’¡ ${esc(e.action)}</div></div>`;
  });
  document.getElementById('sec-email').innerHTML=html+cta();
}

/* INTEL */
async function renderIntel(){
  const d=await loadJSON('data/intel.json');
  const items=d?.items||d?.opportunities||d?.entries||[];
  let html='<h1 class="page-title">Competitive Intel</h1><p class="page-sub">AI-monitored industry intelligence and actionable insights</p>';
  items.forEach((item,i)=>{
    const rc=item.relevance>=80?'background:rgba(240,64,96,.15);color:var(--red)':item.relevance>=60?'background:rgba(240,192,64,.15);color:var(--yellow)':'background:rgba(64,128,240,.15);color:var(--blue)';
    html+=`<div class="intel-card" style="animation-delay:${i*80}ms"><div class="intel-title">${esc(item.title)}</div><div class="intel-meta"><span>ðŸ“° ${esc(item.source)}</span><span>ðŸ“… ${esc(item.date)}</span><span class="intel-relevance" style="${rc}">${item.relevance}% relevant</span><span class="badge" style="background:rgba(64,128,240,.1);color:var(--blue)">${esc(item.category)}</span></div><div class="intel-body">${esc(item.summary)}</div><div class="intel-insight">ðŸ’¡ <strong>Insight:</strong> ${esc(item.insight)}</div></div>`;
  });
  document.getElementById('sec-intel').innerHTML=html+cta();
}

/* REPORTS */
async function renderReports(){
  const d=await loadJSON('data/reports.json');
  const reports=d?.reports||[];
  let html='<h1 class="page-title">Reports</h1><p class="page-sub">Auto-generated reports and analyses</p>';
  reports.forEach((r,i)=>{
    html+=`<div class="report-card" style="animation-delay:${i*80}ms"><div class="report-header"><span class="report-title">${esc(r.title)}</span><span class="report-badge">ðŸ“¥ ${esc(r.status)}</span></div><div class="report-meta">${esc(r.type)} â€¢ ${esc(r.date)}</div><div class="report-summary">${esc(r.summary)}</div></div>`;
  });
  document.getElementById('sec-reports').innerHTML=html+cta();
}

/* READING */
async function renderReading(){
  const d=await loadJSON('data/reading-list.json');
  const items=d?.items||[];
  let html='<h1 class="page-title">Reading List</h1><p class="page-sub">Books, articles, and reports â€” tracked and organized</p>';
  items.forEach((item,i)=>{
    html+=`<div class="reading-item" style="animation-delay:${i*50}ms"><span class="reading-status ${item.status}">${item.status}</span><div style="flex:1;min-width:0"><div class="reading-title">${esc(item.title)}</div><div class="reading-author">${esc(item.author)}${item.note?` â€” <em>${esc(item.note)}</em>`:''}</div></div><span class="reading-type">${esc(item.type)}</span>${item.progress!=null?`<div class="progress-bar"><div class="progress-fill" style="width:${item.progress}%"></div></div>`:''}</div>`;
  });
  document.getElementById('sec-reading').innerHTML=html+cta();
}

/* OUTREACH */
async function renderOutreach(){
  const d=await loadJSON('data/outreach.json');
  const drafts=d?.drafts||[];
  let html='<h1 class="page-title">Outreach</h1><p class="page-sub">AI-drafted outreach emails ready for review</p>';
  drafts.forEach((o,i)=>{
    html+=`<div class="outreach-card" style="animation-delay:${i*80}ms"><div class="outreach-header"><span class="outreach-recipient">${esc(o.recipient)}</span><span class="outreach-status ${o.status}">${o.status==='sent'?'âœ… Sent':'ðŸ“ Ready'}</span></div><div class="outreach-subject">Subject: ${esc(o.subject)}</div><div class="outreach-body" onclick="this.classList.toggle('expanded')">${esc(o.body)}</div><div class="outreach-context">ðŸŽ¯ ${esc(o.context)}</div></div>`;
  });
  document.getElementById('sec-outreach').innerHTML=html+cta();
}

// Expenses / Receipts
{
  const EXP_CATS={meals:'ðŸ½ Meals',travel:'âœˆï¸ Travel',office:'ðŸ¢ Office',software:'ðŸ’» Software',vehicle:'ðŸš— Vehicle',professional:'ðŸ“‹ Professional',other:'ðŸ“¦ Other'};
  const EXP_COLORS={meals:'#EC4899',travel:'#3B82F6',office:'#8B5CF6',software:'#06B6D4',vehicle:'#EF4444',professional:'#10B981',other:'#6B7280'};
  const PERSON_COLORS={Alex:'#3B82F6',Jordan:'#F59E0B',Sam:'#10B981',Taylor:'#8B5CF6'};
  const sampleExpenses=[
    {id:'d1',person:'Alex',vendor:'Delta Airlines',amount:847.50,currency:'USD',date:'2026-02-18',category:'travel',notes:'SaaStr Annual â€” SFO round trip',status:'approved',image:''},
    {id:'d2',person:'Jordan',vendor:'AWS',amount:2340.00,currency:'USD',date:'2026-02-15',category:'software',notes:'Monthly infrastructure',status:'reimbursed',image:''},
    {id:'d3',person:'Alex',vendor:'WeWork',amount:450.00,currency:'USD',date:'2026-02-01',category:'office',notes:'Coworking â€” February',status:'approved',image:''},
    {id:'d4',person:'Sam',vendor:'Figma',amount:75.00,currency:'USD',date:'2026-02-10',category:'software',notes:'Team plan',status:'pending',image:''},
    {id:'d5',person:'Taylor',vendor:'Client dinner â€” Nobu',amount:389.00,currency:'USD',date:'2026-02-14',category:'meals',notes:'Enterprise prospect dinner',status:'pending',image:''},
    {id:'d6',person:'Sam',vendor:'Uber',amount:62.40,currency:'USD',date:'2026-02-19',category:'travel',notes:'Airport transfer',status:'pending',image:''},
    {id:'d7',person:'Jordan',vendor:'Vercel Pro',amount:20.00,currency:'USD',date:'2026-02-01',category:'software',notes:'Monthly hosting',status:'reimbursed',image:''},
    {id:'d8',person:'Alex',vendor:'Staples',amount:134.50,currency:'USD',date:'2026-02-12',category:'office',notes:'Monitor stand + cables',status:'approved',image:''},
    {id:'d9',person:'Taylor',vendor:'LinkedIn Sales Nav',amount:99.99,currency:'USD',date:'2026-02-01',category:'software',notes:'Monthly subscription',status:'reimbursed',image:''},
    {id:'d10',person:'Sam',vendor:'Baker McKenzie',amount:1500.00,currency:'USD',date:'2026-02-08',category:'professional',notes:'Contract review â€” Series A',status:'pending',image:''},
  ];
  let expenses=JSON.parse(localStorage.getItem('demo-expenses')||'null')||sampleExpenses;
  function saveExp(){localStorage.setItem('demo-expenses',JSON.stringify(expenses))}

  function openExpModal(editId){
    const r=editId?expenses.find(x=>x.id===editId):null;
    let h=`<h2>${r?'Edit':'âž• New'} Expense</h2><div style="display:flex;flex-direction:column;gap:12px;margin-top:16px">
      <select id="dx-person" style="padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:14px;font-family:inherit">
        <option value="">Who paid?</option>${['Alex','Jordan','Sam','Taylor'].map(p=>`<option${r&&r.person===p?' selected':''}>${p}</option>`).join('')}
      </select>
      <input id="dx-vendor" value="${r?esc(r.vendor):''}" placeholder="Vendor / merchant" style="padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:14px;font-family:inherit">
      <div style="display:flex;gap:10px">
        <input id="dx-amount" type="number" step="0.01" value="${r?r.amount:''}" placeholder="Amount ($)" style="flex:1;padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:14px;font-family:inherit">
        <input id="dx-date" type="date" value="${r?r.date:new Date().toISOString().slice(0,10)}" style="flex:1;padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:14px;font-family:inherit">
      </div>
      <select id="dx-cat" style="padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:14px;font-family:inherit">
        ${Object.entries(EXP_CATS).map(([k,v])=>`<option value="${k}"${r&&r.category===k?' selected':''}>${v}</option>`).join('')}
      </select>
      <textarea id="dx-notes" rows="2" placeholder="Notes" style="padding:10px 14px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:14px;font-family:inherit;resize:vertical">${r?esc(r.notes||''):''}</textarea>
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
        <label style="padding:10px 16px;border-radius:8px;border:1px dashed var(--border);background:var(--surface2);color:var(--text2);font-size:13px;cursor:pointer;display:flex;align-items:center;gap:6px">ðŸ“· Take Photo<input type="file" accept="image/*" capture="environment" style="display:none" onchange="demoExpPreview(this)"></label>
        <label style="padding:10px 16px;border-radius:8px;border:1px dashed var(--border);background:var(--surface2);color:var(--text2);font-size:13px;cursor:pointer;display:flex;align-items:center;gap:6px">ðŸ“„ Upload File<input type="file" accept="image/*,.pdf,.heic,.heif" style="display:none" onchange="demoExpPreview(this)"></label>
        <span id="dx-photo-name" style="font-size:12px;color:var(--text2)">${r&&r.image?'ðŸ“Ž Attached':''}</span>
      </div>
      <div id="dx-photo-preview" style="display:${r&&r.image?'block':'none'}"><img id="dx-photo-img" src="${r&&r.image||''}" style="max-width:100%;max-height:200px;border-radius:8px;border:1px solid var(--border)"></div>
      <div style="display:flex;gap:10px">
        <button onclick="submitDemoExp('${editId||''}')" style="flex:1;padding:12px;border-radius:8px;border:none;background:var(--blue);color:#fff;font-size:14px;font-weight:600;cursor:pointer;font-family:inherit">${r?'Save':'Add Expense'}</button>
        ${r?`<button onclick="expenses=expenses.filter(x=>x.id!=='${editId}');saveExp();document.getElementById('exp-modal').classList.remove('open');renderExp()" style="padding:12px 16px;border-radius:8px;border:1px solid #EF4444;background:transparent;color:#EF4444;cursor:pointer;font-family:inherit">ðŸ—‘</button>`:''}
      </div></div>`;
    document.getElementById('exp-modal-body').innerHTML=h;
    document.getElementById('exp-modal').classList.add('open');
  }
  window.openExpModal=openExpModal;
  window.demoExpPreview=function(input){if(input.files&&input.files[0]){const r=new FileReader();r.onload=e=>{document.getElementById('dx-photo-preview').style.display='block';document.getElementById('dx-photo-img').src=e.target.result;document.getElementById('dx-photo-name').textContent='ðŸ“Ž '+input.files[0].name};r.readAsDataURL(input.files[0])}};
  window.submitDemoExp=function(editId){
    const person=document.getElementById('dx-person').value;
    const vendor=document.getElementById('dx-vendor').value.trim();
    const amount=parseFloat(document.getElementById('dx-amount').value);
    if(!vendor||isNaN(amount))return;
    const img=document.getElementById('dx-photo-img');
    const image=img&&img.src&&img.src.startsWith('data:')?img.src:'';
    const data={person:person||'Unknown',vendor,amount,currency:'USD',date:document.getElementById('dx-date').value,category:document.getElementById('dx-cat').value,notes:document.getElementById('dx-notes').value.trim(),status:'pending',image:image||(editId?((expenses.find(r=>r.id===editId)||{}).image||''):'')};
    if(editId){const i=expenses.findIndex(r=>r.id===editId);if(i>=0){data.status=expenses[i].status;Object.assign(expenses[i],data)}}else{data.id='d'+Date.now();expenses.unshift(data)}
    saveExp();document.getElementById('exp-modal').classList.remove('open');renderExp();
  };
  window.setDemoExpStatus=function(id,s){const e=expenses.find(x=>x.id===id);if(e){e.status=s;saveExp();renderExp();document.getElementById('exp-view').classList.remove('open')}};

  function viewExp(id){
    const r=expenses.find(x=>x.id===id);if(!r)return;
    const pc=PERSON_COLORS[r.person]||'#6B7280';
    const st={pending:'â³ Pending',approved:'âœ… Approved',reimbursed:'ðŸ’° Reimbursed'}[r.status]||r.status;
    document.getElementById('exp-view-body').innerHTML=`<div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:16px">
      <div><h2 style="margin:0">${esc(r.vendor)}</h2><div style="font-size:13px;color:var(--text2);margin-top:4px">${esc(r.date)} Â· ${esc(EXP_CATS[r.category]||r.category)}</div>
      <div style="margin-top:6px"><span style="font-size:10px;font-weight:700;padding:2px 8px;border-radius:10px;color:#fff;background:${pc}">${esc(r.person)}</span> <span style="font-size:12px;color:var(--text2)">${st}</span></div></div>
      <div style="font-size:24px;font-weight:800;color:#40c080">$${r.amount.toFixed(2)}</div></div>
    ${r.notes?`<div style="font-size:13px;color:var(--text2);margin-bottom:16px">${esc(r.notes)}</div>`:''}
    ${r.image?`<img src="${r.image}" style="max-width:100%;border-radius:8px;border:1px solid var(--border);margin-bottom:16px">`:''}
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px">
      ${r.status!=='approved'?`<button onclick="setDemoExpStatus('${r.id}','approved')" style="padding:8px 16px;border-radius:8px;border:1px solid #40c080;background:transparent;color:#40c080;font-size:12px;font-weight:600;cursor:pointer;font-family:inherit">âœ… Approve</button>`:''}
      ${r.status!=='reimbursed'?`<button onclick="setDemoExpStatus('${r.id}','reimbursed')" style="padding:8px 16px;border-radius:8px;border:1px solid #F59E0B;background:transparent;color:#F59E0B;font-size:12px;font-weight:600;cursor:pointer;font-family:inherit">ðŸ’° Reimburse</button>`:''}
    </div>
    <div style="display:flex;gap:10px">
      <button onclick="openExpModal('${r.id}');document.getElementById('exp-view').classList.remove('open')" style="flex:1;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-size:13px;font-weight:600;cursor:pointer;font-family:inherit">âœï¸ Edit</button>
      <button onclick="expenses=expenses.filter(x=>x.id!=='${r.id}');saveExp();document.getElementById('exp-view').classList.remove('open');renderExp()" style="padding:10px 16px;border-radius:8px;border:1px solid #EF4444;background:transparent;color:#EF4444;cursor:pointer;font-family:inherit">ðŸ—‘</button>
    </div>`;
    document.getElementById('exp-view').classList.add('open');
  }
  window.viewExp=viewExp;

  window.renderExp=function(){
    const sec=document.getElementById('sec-expenses');if(!sec)return;
    const byPerson={};expenses.forEach(r=>{byPerson[r.person]=byPerson[r.person]||{t:0,c:0};byPerson[r.person].t+=r.amount;byPerson[r.person].c++});
    const total=expenses.reduce((s,r)=>s+r.amount,0);
    let sumHTML='';Object.entries(byPerson).sort((a,b)=>b[1].t-a[1].t).forEach(([n,d])=>{
      const c=PERSON_COLORS[n]||'#6B7280';
      sumHTML+=`<div style="background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:14px 16px;text-align:center;border-color:${c}44"><div style="font-size:13px;font-weight:700;color:${c}">${esc(n)}</div><div style="font-size:20px;font-weight:800">$${d.t.toFixed(0)}</div><div style="font-size:11px;color:var(--text2)">${d.c} receipts</div></div>`;
    });
    let listHTML='';expenses.sort((a,b)=>(b.date||'').localeCompare(a.date||'')).forEach((r,i)=>{
      const color=EXP_COLORS[r.category]||'#6B7280';const icon=EXP_CATS[r.category]?EXP_CATS[r.category].split(' ')[0]:'ðŸ“¦';
      const pc=PERSON_COLORS[r.person]||'#6B7280';const si={pending:'â³',approved:'âœ…',reimbursed:'ðŸ’°'}[r.status]||'';
      listHTML+=`<div style="background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:16px 20px;margin-bottom:10px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:16px;opacity:1;animation:cardIn .4s ease forwards;animation-delay:${i*50}ms" onclick="viewExp('${r.id}')" onmouseover="this.style.borderColor='#3a3a4a'" onmouseout="this.style.borderColor=''">
        <div style="width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;background:${color}22;color:${color};flex-shrink:0">${icon}</div>
        <div style="flex:1;min-width:0"><div style="font-size:14px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${esc(r.vendor)}</div><div style="font-size:12px;color:var(--text2);white-space:nowrap;overflow:hidden;text-overflow:ellipsis"><span style="font-size:10px;font-weight:700;padding:1px 6px;border-radius:6px;color:#fff;background:${pc}">${esc(r.person)}</span> ${esc(EXP_CATS[r.category]||'')}${r.notes?' Â· '+esc(r.notes):''}</div></div>
        <div style="text-align:right"><div style="font-size:16px;font-weight:700;color:#40c080">${si} $${r.amount.toFixed(2)}</div><div style="font-size:11px;color:var(--text2)">${esc(r.date)}</div></div>
      </div>`;
    });
    sec.innerHTML=`<h1 class="page-title">Expenses</h1><p class="page-sub">Track team expenses and receipts Â· Snap a photo or upload a file</p>
      <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;align-items:center">
        <button onclick="openExpModal()" style="padding:10px 20px;border-radius:8px;border:none;background:var(--blue);color:#fff;font-size:13px;font-weight:600;cursor:pointer;font-family:inherit;display:flex;align-items:center;gap:6px"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg> Add Expense</button>
        <div style="margin-left:auto;font-size:14px;font-weight:700">${expenses.length} expenses Â· $${total.toFixed(2)}</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-bottom:24px">${sumHTML}</div>
      ${listHTML}
      <div id="exp-modal" class="kanban-modal" onclick="if(event.target===this)this.classList.remove('open')"><div class="kanban-modal-content" id="exp-modal-body" style="max-width:480px"></div></div>
      <div id="exp-view" class="kanban-modal" onclick="if(event.target===this)this.classList.remove('open')"><div class="kanban-modal-content" id="exp-view-body" style="max-width:560px"></div></div>`;
    const b=document.getElementById('expenses-badge');if(b){b.textContent=expenses.length;b.style.display='';}
  };
  renderExp();
}

/* STOCKS */
async function renderStocks(){
  const feed=document.getElementById('sec-stocks');
  if(!feed)return;
  try{
    const data=await loadJSON('data/stocks.json');
    if(!data||!data.stocks||!data.stocks.length){
      feed.innerHTML='<h1 class="page-title">ðŸ“ˆ Stocks</h1><p class="page-sub">Daily dividend research â€” updated every morning</p><div style="text-align:center;padding:60px 20px;color:var(--text2)"><div style="font-size:48px;margin-bottom:16px">ðŸ“Š</div><div style="font-size:16px;font-weight:600;color:var(--text);margin-bottom:8px">Researching stocks daily.</div><p>Next update at 8am. Dividend picks and valuation analysis will appear here.</p></div>'+cta();
      return;
    }
    const updatedStr=data.lastUpdated?new Date(data.lastUpdated).toLocaleString('en-CA',{month:'short',day:'numeric',year:'numeric',hour:'numeric',minute:'2-digit'}):'â€”';
    let html='<h1 class="page-title">ðŸ“ˆ Stocks</h1><p class="page-sub">Daily dividend research â€” updated every morning at 8am</p>';
    html+=`<div class="stocks-header"><div class="stocks-updated">Last updated: ${esc(updatedStr)}</div></div>`;
    html+='<div class="stocks-table-wrap"><table class="stocks-table"><thead><tr>';
    html+='<th>Stock</th><th>Price</th><th>52W Low</th><th>Conservative</th><th>Optimistic</th><th>Thesis</th>';
    html+='</tr></thead><tbody>';
    data.stocks.forEach((s,idx)=>{
      const price=s.currentPrice||0;
      const cons=s.conservativeEstimate||0;
      const opt=s.optimisticEstimate||0;
      let rowClass='sv-fullvalued';
      if(cons&&price<cons)rowClass='sv-undervalued';
      else if(cons&&opt&&price>=cons&&price<=opt)rowClass='sv-midvalued';
      const ratingKey=(s.rating||'').toLowerCase().replace(/\s/g,'');
      const ratingClass=ratingKey==='strongbuy'?'strongbuy':ratingKey==='buy'?'buy':ratingKey==='hold'?'hold':'watch';
      const cur=s.currency||'CAD';
      const priceFmt=price?`${cur} $${price.toFixed(2)}`:'â€”';
      const consFmt=cons?`$${cons.toFixed(2)}`:'â€”';
      const optFmt=opt?`$${opt.toFixed(2)}`:'â€”';
      const low52Fmt=s.week52Low?`$${s.week52Low.toFixed(2)}`:'â€”';
      const vsLow=s.priceVs52wLow||'';
      const thesisId=`thesis-${idx}`;
      const sentences=(s.thesis||'').split(/\.\s/);
      const firstSentence=sentences[0]+(sentences.length>1&&s.thesis&&s.thesis.includes('.')?'.':'');
      const hasMore=sentences.length>1;
      html+=`<tr class="${rowClass}">`;
      html+=`<td><div class="stock-ticker">${esc(s.ticker||'')}</div><div class="stock-name">${esc(s.name||'')}</div><div class="stock-yield">${esc(s.yield||'')}</div><span class="stock-rating ${ratingClass}">${esc(s.rating||'')}</span></td>`;
      html+=`<td><div class="stock-price">${esc(priceFmt)}</div></td>`;
      html+=`<td><div class="stock-estimate">${esc(low52Fmt)}</div><div class="stock-vs-low">${vsLow?esc(vsLow)+' above low':''}</div></td>`;
      html+=`<td><div class="stock-estimate">${esc(consFmt)}</div></td>`;
      html+=`<td><div class="stock-estimate">${esc(optFmt)}</div></td>`;
      html+=`<td><div class="stock-thesis-preview">${esc(firstSentence)}</div>`;
      if(hasMore){
        html+=`<div class="stock-thesis-full" id="${thesisId}">${esc(s.thesis||'')}</div>`;
        html+=`<span class="stock-thesis-toggle" onclick="toggleThesis('${thesisId}',this)">â–¸ More</span>`;
      }
      if(s.risks)html+=`<div class="stock-risks">âš  ${esc(s.risks)}</div>`;
      if(s.researchDate)html+=`<div class="stock-date">Researched ${esc(s.researchDate)}</div>`;
      html+='</td>';
      html+='</tr>';
    });
    html+='</tbody></table></div>';
    feed.innerHTML=html+cta();
  }catch(e){
    console.error('Stocks panel error:',e);
    document.getElementById('sec-stocks').innerHTML='<h1 class="page-title">ðŸ“ˆ Stocks</h1><p class="page-sub">Daily dividend research â€” updated every morning</p><div style="text-align:center;padding:60px 20px;color:var(--text2)"><div style="font-size:16px;font-weight:600;color:var(--text);margin-bottom:8px">Could not load stock data.</div><p>Researching stocks daily. Next update at 8am.</p></div>'+cta();
  }
}

function toggleThesis(id,btn){
  const el=document.getElementById(id);
  if(!el)return;
  const isOpen=el.style.display==='block';
  el.style.display=isOpen?'none':'block';
  btn.textContent=isOpen?'â–¸ More':'â–´ Less';
}

function renderProjects(){const s=document.getElementById('sec-projects');s.innerHTML=`<h1 class="page-title">Projects</h1><p class="page-sub">Active development portfolio â€” budgets, timelines, and progress</p><div class="kpi-grid"><div class="kpi-card"><div class="kpi-label">Portfolio Value</div><div class="kpi-value" style="color:var(--blue)">$56.3M</div><div class="kpi-sub">3 active developments</div></div><div class="kpi-card"><div class="kpi-label">Total Units</div><div class="kpi-value">129</div><div class="kpi-sub">Across all projects</div></div><div class="kpi-card"><div class="kpi-label">Avg Completion</div><div class="kpi-value" style="color:var(--yellow)">37%</div><div class="kpi-sub">Weighted by value</div></div><div class="kpi-card"><div class="kpi-label">On-Budget Projects</div><div class="kpi-value" style="color:var(--green)">2 / 3</div><div class="kpi-sub">1 project flagged</div></div></div><div class="proj-card"><div class="proj-header"><div><div class="proj-name">Harbour Point Residences</div><div class="proj-meta">Luxury Condominiums Â· Downtown Waterfront</div></div><span class="badge badge-green">On Track</span></div><div class="proj-stats"><div><div class="proj-stat-label">Units</div><div class="proj-stat-value">72</div></div><div><div class="proj-stat-label">Budget</div><div class="proj-stat-value">$28.4M</div></div><div><div class="proj-stat-label">Spent</div><div class="proj-stat-value">$18.6M</div></div><div><div class="proj-stat-label">Variance</div><div class="proj-stat-value kpi-up">-$2.1M âœ“</div></div></div><div style="display:flex;justify-content:space-between;font-size:12px;color:var(--text2);margin-bottom:4px"><span>Completion</span><span style="color:var(--text);font-weight:600">68%</span></div><div class="progress-bar"><div class="progress-fill" style="width:68%;background:var(--green)"></div></div><div style="font-size:12px;color:var(--text2);margin-top:8px">Est. completion: Oct 2026 Â· GC: Meridian Construction</div></div><div class="proj-card"><div class="proj-header"><div><div class="proj-name">The Meridian</div><div class="proj-meta">Mixed-Use Residential Â· Midtown</div></div><span class="badge badge-blue">In Progress</span></div><div class="proj-stats"><div><div class="proj-stat-label">Units</div><div class="proj-stat-value">45</div></div><div><div class="proj-stat-label">Budget</div><div class="proj-stat-value">$18.7M</div></div><div><div class="proj-stat-label">Spent</div><div class="proj-stat-value">$5.9M</div></div><div><div class="proj-stat-label">Variance</div><div class="proj-stat-value" style="color:var(--text2)">On Budget</div></div></div><div style="display:flex;justify-content:space-between;font-size:12px;color:var(--text2);margin-bottom:4px"><span>Completion</span><span style="color:var(--text);font-weight:600">31%</span></div><div class="progress-bar"><div class="progress-fill" style="width:31%;background:var(--blue)"></div></div><div style="font-size:12px;color:var(--text2);margin-top:8px">Est. completion: Mar 2027 Â· GC: Apex Builders</div></div><div class="proj-card" style="border-color:rgba(240,64,96,.3)"><div class="proj-header"><div><div class="proj-name">Westfield Commons</div><div class="proj-meta">Commercial Retail &amp; Office Â· West End</div></div><span class="badge badge-red">Over Budget</span></div><div class="proj-stats"><div><div class="proj-stat-label">Sqft</div><div class="proj-stat-value">42K</div></div><div><div class="proj-stat-label">Budget</div><div class="proj-stat-value">$9.2M</div></div><div><div class="proj-stat-label">Spent</div><div class="proj-stat-value">$1.4M</div></div><div><div class="proj-stat-label">Variance</div><div class="proj-stat-value kpi-down">+$340K âš </div></div></div><div style="display:flex;justify-content:space-between;font-size:12px;color:var(--text2);margin-bottom:4px"><span>Completion</span><span style="color:var(--text);font-weight:600">12%</span></div><div class="progress-bar"><div class="progress-fill" style="width:12%;background:var(--red)"></div></div><div style="font-size:12px;color:var(--text2);margin-top:8px">Est. completion: Aug 2027 Â· GC: Summit Development Group</div></div>`+cta();}

function renderFinancials(){const s=document.getElementById('sec-financials');s.innerHTML=`<h1 class="page-title">Financials</h1><p class="page-sub">Portfolio P&L, capital deployment, and cash position</p><div class="kpi-grid"><div class="kpi-card"><div class="kpi-label">Capital Deployed</div><div class="kpi-value" style="color:var(--blue)">$31.2M</div><div class="kpi-sub kpi-up">â†‘ $2.4M this month</div></div><div class="kpi-card"><div class="kpi-label">Portfolio IRR</div><div class="kpi-value" style="color:var(--green)">22.4%</div><div class="kpi-sub">Projected at completion</div></div><div class="kpi-card"><div class="kpi-label">Monthly Burn</div><div class="kpi-value" style="color:var(--yellow)">$847K</div><div class="kpi-sub">Across 3 projects</div></div><div class="kpi-card"><div class="kpi-label">Cash Position</div><div class="kpi-value">$4.1M</div><div class="kpi-sub">4.8 months runway</div></div></div><div class="table-wrap"><table class="data-table"><thead><tr><th>Project</th><th>Equity Invested</th><th>Proj. Revenue</th><th>Proj. Profit</th><th>IRR</th><th>Status</th></tr></thead><tbody><tr><td style="font-weight:600">Harbour Point</td><td>$9.9M</td><td>$36.2M</td><td>$7.8M</td><td style="color:var(--green);font-weight:600">24.1%</td><td><span class="badge badge-green">On Track</span></td></tr><tr><td style="font-weight:600">The Meridian</td><td>$6.5M</td><td>$24.8M</td><td>$6.1M</td><td style="color:var(--green);font-weight:600">21.8%</td><td><span class="badge badge-blue">In Progress</span></td></tr><tr><td style="font-weight:600">Westfield Commons</td><td>$3.2M</td><td>$14.1M</td><td>$4.9M</td><td style="color:var(--yellow);font-weight:600">18.4%</td><td><span class="badge badge-red">Over Budget</span></td></tr></tbody></table></div>`+cta();}

function renderInventory(){const s=document.getElementById('sec-inventory');s.innerHTML=`<h1 class="page-title">Inventory</h1><p class="page-sub">Unit tracker â€” availability, pricing, and absorption rate</p><div class="kpi-grid"><div class="kpi-card" style="border-color:rgba(64,192,128,.2)"><div class="kpi-label">Available</div><div class="kpi-value" style="color:var(--green)">47</div><div class="kpi-sub">Ready to sell</div></div><div class="kpi-card" style="border-color:rgba(240,192,64,.2)"><div class="kpi-label">Under Contract</div><div class="kpi-value" style="color:var(--yellow)">23</div><div class="kpi-sub">Deposits received</div></div><div class="kpi-card" style="border-color:rgba(64,128,240,.2)"><div class="kpi-label">Sold / Closed</div><div class="kpi-value" style="color:var(--blue)">59</div><div class="kpi-sub">31 sold Â· 28 closed</div></div><div class="kpi-card"><div class="kpi-label">Absorption Rate</div><div class="kpi-value">8.3</div><div class="kpi-sub kpi-up">units/month â†‘ 12%</div></div></div><div class="table-wrap"><table class="data-table"><thead><tr><th>Unit</th><th>Project</th><th>Type</th><th>Sqft</th><th>List Price</th><th>$/Sqft</th><th>Status</th><th>DOM</th></tr></thead><tbody><tr><td style="font-weight:600">HP-401</td><td>Harbour Point</td><td>Penthouse</td><td>2,840</td><td style="font-weight:600">$3.2M</td><td>$1,127</td><td><span class="badge badge-green">Available</span></td><td>12</td></tr><tr><td style="font-weight:600">HP-302</td><td>Harbour Point</td><td>3BR</td><td>1,620</td><td style="font-weight:600">$1.48M</td><td>$914</td><td><span class="badge badge-yellow">Contract</span></td><td>8</td></tr><tr><td style="font-weight:600">HP-215</td><td>Harbour Point</td><td>2BR</td><td>1,140</td><td style="font-weight:600">$980K</td><td>$860</td><td><span class="badge badge-blue">Sold</span></td><td>5</td></tr><tr><td style="font-weight:600">MR-201</td><td>The Meridian</td><td>2BR</td><td>1,050</td><td style="font-weight:600">$895K</td><td>$852</td><td><span class="badge badge-yellow">Contract</span></td><td>3</td></tr><tr><td style="font-weight:600">MR-105</td><td>The Meridian</td><td>1BR</td><td>690</td><td style="font-weight:600">$575K</td><td>$833</td><td><span class="badge badge-green">Available</span></td><td>34</td></tr><tr><td style="font-weight:600">MR-310</td><td>The Meridian</td><td>3BR</td><td>1,540</td><td style="font-weight:600">$1.32M</td><td>$857</td><td><span class="badge badge-green">Available</span></td><td>18</td></tr><tr><td style="font-weight:600">MR-408</td><td>The Meridian</td><td>Penthouse</td><td>2,680</td><td style="font-weight:600">$2.95M</td><td>$1,101</td><td><span class="badge badge-yellow">Contract</span></td><td>2</td></tr></tbody></table></div>`+cta();}

function renderPipeline2(){const s=document.getElementById('sec-pipeline2');if(s)s.id='sec-pipeline2';document.getElementById('pipeline2-badge')&&(document.getElementById('pipeline2-badge').textContent='18');const el=document.getElementById('sec-pipeline2');if(!el)return;el.innerHTML=`<h1 class="page-title">Deal Pipeline</h1><p class="page-sub">The CRM That Fills Itself â€” AI sources and tracks every buyer and investor lead</p><div class="kpi-grid" style="margin-bottom:20px"><div class="kpi-card"><div class="kpi-label">Total Leads</div><div class="kpi-value">18</div><div class="kpi-sub">Active pipeline</div></div><div class="kpi-card"><div class="kpi-label">AI Sourced</div><div class="kpi-value" style="color:var(--blue)">11</div><div class="kpi-sub">Added automatically</div></div><div class="kpi-card"><div class="kpi-label">Offers Out</div><div class="kpi-value" style="color:var(--yellow)">4</div><div class="kpi-sub">Awaiting response</div></div><div class="kpi-card"><div class="kpi-label">Closed MTD</div><div class="kpi-value" style="color:var(--green)">3</div><div class="kpi-sub">$4.2M total value</div></div></div><div class="kanban"><div class="kanban-col"><div class="kanban-col-title">New Leads <span class="kanban-count">5</span></div><div class="k-card"><div class="k-name">James Whitmore</div><div class="k-detail">2BR Harbour Point Â· $980Kâ€“$1.1M</div><div class="k-footer"><span class="k-days">Today</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card"><div class="k-name">Priya Anand</div><div class="k-detail">Investor Â· $500K equity interest</div><div class="k-footer"><span class="k-days">1d ago</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card"><div class="k-name">Chen &amp; Associates</div><div class="k-detail">Commercial unit inquiry Â· Westfield</div><div class="k-footer"><span class="k-days">2d ago</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card"><div class="k-name">Marcus Reid</div><div class="k-detail">Penthouse interest Â· HP-401</div><div class="k-footer"><span class="k-days">2d ago</span></div></div><div class="k-card"><div class="k-name">Sofia Bertrand</div><div class="k-detail">3BR Meridian Â· Pre-sale pricing</div><div class="k-footer"><span class="k-days">3d ago</span><span class="k-ai">ðŸ¤– AI</span></div></div></div><div class="kanban-col"><div class="kanban-col-title">Contacted <span class="kanban-count">4</span></div><div class="k-card"><div class="k-name">David &amp; Lisa Park</div><div class="k-detail">2BR HP Â· Site visit requested</div><div class="k-footer"><span class="k-days">4d ago</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card"><div class="k-name">Thompson Capital</div><div class="k-detail">LP interest Â· $750K commitment</div><div class="k-footer"><span class="k-days">5d ago</span></div></div><div class="k-card"><div class="k-name">Amara Osei</div><div class="k-detail">1BR Meridian Â· First-time buyer</div><div class="k-footer"><span class="k-days">6d ago</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card"><div class="k-name">Robert Vance</div><div class="k-detail">Investor Â· $1.2M equity</div><div class="k-footer"><span class="k-days">1w ago</span></div></div></div><div class="kanban-col"><div class="kanban-col-title">Site Visit <span class="kanban-count">3</span></div><div class="k-card" style="border-color:rgba(64,192,128,.3)"><div class="k-name">Nathan &amp; Claire Hughes</div><div class="k-detail">3BR HP-309 Â· Very interested</div><div class="k-footer"><span class="k-days">Visited Tue</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card"><div class="k-name">Elaine Morrison</div><div class="k-detail">Penthouse MR-408 Â· Second visit</div><div class="k-footer"><span class="k-days">Visited Wed</span></div></div><div class="k-card"><div class="k-name">Pacific Vest Corp</div><div class="k-detail">Commercial Westfield Â· 4 suites</div><div class="k-footer"><span class="k-days">Visited Thu</span><span class="k-ai">ðŸ¤– AI</span></div></div></div><div class="kanban-col"><div class="kanban-col-title">Offer Out <span class="kanban-count">4</span></div><div class="k-card" style="border-color:rgba(240,192,64,.3)"><div class="k-name">Yuki Tanaka</div><div class="k-detail">HP-302 Â· $1.44M offer sent</div><div class="k-footer"><span class="k-days">2d pending</span><span class="k-ai">ðŸ¤– AI</span></div></div><div class="k-card" style="border-color:rgba(240,192,64,.3)"><div class="k-name">Beacon Holdings</div><div class="k-detail">LP offer Â· $500K Â· 8% pref</div><div class="k-footer"><span class="k-days">3d pending</span></div></div><div class="k-card" style="border-color:rgba(240,192,64,.3)"><div class="k-name">Michael Torres</div><div class="k-detail">MR-201 Â· $880K offer sent</div><div class="k-footer"><span class="k-days">4d pending</span></div></div><div class="k-card" style="border-color:rgba(240,192,64,.3)"><div class="k-name">Fiona &amp; Dale Marsh</div><div class="k-detail">HP-215 Â· $975K counter offer</div><div class="k-footer"><span class="k-days">1d pending</span><span class="k-ai">ðŸ¤– AI</span></div></div></div><div class="kanban-col"><div class="kanban-col-title">Closed âœ“ <span class="kanban-count">2</span></div><div class="k-card" style="opacity:.8;border-color:rgba(64,192,128,.3)"><div class="k-name">Harrison Group</div><div class="k-detail">HP-118 Â· $638K Â· Feb 14</div><div class="k-footer"><span class="k-days" style="color:var(--green)">âœ“ Closed</span></div></div><div class="k-card" style="opacity:.8;border-color:rgba(64,192,128,.3)"><div class="k-name">Andrea Fontaine</div><div class="k-detail">MR-105 Â· $582K Â· Feb 19</div><div class="k-footer"><span class="k-days" style="color:var(--green)">âœ“ Closed</span></div></div></div></div>`+cta();}

function renderMarket(){const s=document.getElementById('sec-market');s.innerHTML=`<h1 class="page-title">Market Intel</h1><p class="page-sub">Real-time market data, comparable sales, and AI-generated insights</p><div class="kpi-grid"><div class="kpi-card"><div class="kpi-label">30-Year Fixed Rate</div><div class="kpi-value" style="color:var(--yellow)">6.82%</div><div class="kpi-sub kpi-down">â†‘ 0.12% this week</div></div><div class="kpi-card"><div class="kpi-label">Avg Sold $/Sqft</div><div class="kpi-value" style="color:var(--blue)">$847</div><div class="kpi-sub kpi-up">â†‘ 4.2% YoY</div></div><div class="kpi-card"><div class="kpi-label">Avg Days on Market</div><div class="kpi-value">23</div><div class="kpi-sub kpi-up">â†“ 8 days vs last yr</div></div><div class="kpi-card"><div class="kpi-label">List-to-Sale Ratio</div><div class="kpi-value" style="color:var(--green)">94%</div><div class="kpi-sub">Downtown submarket</div></div></div><div class="intel-card"><div class="intel-ai-label">ðŸ¤– AI Market Insight â€” Updated Feb 24, 2026</div><div style="font-size:14px;line-height:1.7">Absorption rates in the downtown submarket have increased <strong style="color:var(--blue)">18% YoY</strong>, driven by constrained supply and continued in-migration. Comparable penthouse sales are averaging <strong style="color:var(--green)">$1,087/sqft</strong> â€” your HP-401 ask of $1,127/sqft is positioned at a <strong>3.7% premium</strong>, which is supportable given the waterfront premium.<br><br>Recommend: Accelerate pricing on HP-302 and MR-408 by <strong style="color:var(--yellow)">3â€“5%</strong> before Q2. Rate trajectory suggests buyers will accelerate purchase timelines if rates tick above 7%. <strong>Window: next 6â€“8 weeks.</strong></div></div>`+cta();}

function renderPermits(){const s=document.getElementById('sec-permits');s.innerHTML=`<h1 class="page-title">Permits &amp; Compliance</h1><p class="page-sub">Active permits, inspection schedule, and compliance tracker</p><div class="kpi-grid" style="margin-bottom:20px"><div class="kpi-card"><div class="kpi-label">Active Permits</div><div class="kpi-value">9</div><div class="kpi-sub">Across 3 projects</div></div><div class="kpi-card"><div class="kpi-label">Approved</div><div class="kpi-value" style="color:var(--green)">5</div><div class="kpi-sub">Active &amp; valid</div></div><div class="kpi-card"><div class="kpi-label">Pending Review</div><div class="kpi-value" style="color:var(--yellow)">3</div><div class="kpi-sub">Avg 12 days wait</div></div><div class="kpi-card"><div class="kpi-label">Inspections This Week</div><div class="kpi-value" style="color:var(--blue)">4</div><div class="kpi-sub">Next: Feb 25</div></div></div><div class="table-wrap"><table class="data-table"><thead><tr><th>Permit #</th><th>Project</th><th>Type</th><th>Status</th></tr></thead><tbody><tr><td style="font-family:monospace;color:var(--blue)">BP-2024-0847</td><td>Harbour Point</td><td>Building</td><td><span class="badge badge-green">Approved</span></td></tr><tr><td style="font-family:monospace;color:var(--blue)">EP-2024-1203</td><td>Harbour Point</td><td>Electrical</td><td><span class="badge badge-green">Approved</span></td></tr><tr><td style="font-family:monospace;color:var(--blue)">BP-2025-0312</td><td>The Meridian</td><td>Building</td><td><span class="badge badge-yellow">Pending</span></td></tr><tr><td style="font-family:monospace;color:var(--blue)">MP-2025-0445</td><td>The Meridian</td><td>Mechanical</td><td><span class="badge badge-yellow">In Review</span></td></tr><tr><td style="font-family:monospace;color:var(--blue)">BP-2025-0567</td><td>Westfield Commons</td><td>Building</td><td><span class="badge badge-yellow">Pending</span></td></tr><tr><td style="font-family:monospace;color:var(--blue)">FP-2025-0112</td><td>The Meridian</td><td>Fire Safety</td><td><span class="badge badge-green">Approved</span></td></tr></tbody></table></div>`+cta();}

function renderContractors(){const s=document.getElementById('sec-contractors');s.innerHTML=`<h1 class="page-title">Contractors</h1><p class="page-sub">Trade schedule, contract status, and payment tracker</p><div class="kpi-grid" style="margin-bottom:20px"><div class="kpi-card"><div class="kpi-label">Active Trades</div><div class="kpi-value">8</div><div class="kpi-sub">Across 3 sites</div></div><div class="kpi-card"><div class="kpi-label">Paid This Month</div><div class="kpi-value" style="color:var(--green)">$2.3M</div><div class="kpi-sub">12 invoices cleared</div></div><div class="kpi-card"><div class="kpi-label">Due Next 30 Days</div><div class="kpi-value" style="color:var(--yellow)">$890K</div><div class="kpi-sub">7 upcoming invoices</div></div><div class="kpi-card"><div class="kpi-label">Overdue</div><div class="kpi-value" style="color:var(--red)">$84K</div><div class="kpi-sub kpi-down">âš  1 contractor flagged</div></div></div><div class="table-wrap"><table class="data-table"><thead><tr><th>Company</th><th>Trade</th><th>Project</th><th>Contract</th><th>Paid to Date</th><th>Next Payment</th><th>Status</th></tr></thead><tbody><tr><td style="font-weight:600">Meridian Construction</td><td>General</td><td>Harbour Point</td><td>$8.4M</td><td>$5.9M</td><td>Mar 1 Â· $420K</td><td><span class="badge badge-green">On Schedule</span></td></tr><tr><td style="font-weight:600">Apex Builders</td><td>General</td><td>The Meridian</td><td>$5.2M</td><td>$1.6M</td><td>Mar 5 Â· $260K</td><td><span class="badge badge-green">On Schedule</span></td></tr><tr><td style="font-weight:600">Summit Dev. Group</td><td>General</td><td>Westfield Commons</td><td>$2.8M</td><td>$420K</td><td>Feb 28 Â· $140K</td><td><span class="badge badge-yellow">Minor Delay</span></td></tr><tr><td style="font-weight:600">Volt Electric Co.</td><td>Electrical</td><td>Harbour Point</td><td>$1.2M</td><td>$740K</td><td>Mar 10 Â· $120K</td><td><span class="badge badge-green">On Schedule</span></td></tr><tr style="background:rgba(240,64,96,.04)"><td style="font-weight:600">ThermaAir HVAC</td><td>HVAC</td><td>Harbour Point</td><td>$940K</td><td>$580K</td><td style="color:var(--red);font-weight:600">âš  Overdue $84K</td><td><span class="badge badge-red">Overdue</span></td></tr></tbody></table></div>`+cta();}

function renderInvestors(){const s=document.getElementById('sec-investors');s.innerHTML=`<h1 class="page-title">Investors</h1><p class="page-sub">LP summary, capital calls, distributions, and returns</p><div class="kpi-grid" style="margin-bottom:20px"><div class="kpi-card"><div class="kpi-label">Total Raise</div><div class="kpi-value" style="color:var(--blue)">$12.4M</div><div class="kpi-sub">8 limited partners</div></div><div class="kpi-card"><div class="kpi-label">Capital Called</div><div class="kpi-value">$9.8M</div><div class="kpi-sub">79% of commitments</div></div><div class="kpi-card"><div class="kpi-label">Distributions Paid</div><div class="kpi-value" style="color:var(--green)">$1.24M</div><div class="kpi-sub">Since inception</div></div><div class="kpi-card"><div class="kpi-label">Preferred Return</div><div class="kpi-value" style="color:var(--yellow)">8%</div><div class="kpi-sub">Current: 9.2% actual</div></div></div><div class="table-wrap"><table class="data-table"><thead><tr><th>Investor</th><th>Commitment</th><th>Called</th><th>Distributions</th><th>Net IRR</th><th>Status</th></tr></thead><tbody><tr><td><div style="display:flex;align-items:center;gap:10px"><span class="avatar">TH</span><span style="font-weight:600">Thompson Holdings</span></div></td><td>$2.4M</td><td>$2.0M</td><td>$320K</td><td style="color:var(--green);font-weight:600">11.2%</td><td><span class="badge badge-green">Current</span></td></tr><tr><td><div style="display:flex;align-items:center;gap:10px"><span class="avatar">PV</span><span style="font-weight:600">Pinnacle Ventures</span></div></td><td>$2.0M</td><td>$1.6M</td><td>$210K</td><td style="color:var(--green);font-weight:600">10.8%</td><td><span class="badge badge-green">Current</span></td></tr><tr><td><div style="display:flex;align-items:center;gap:10px"><span class="avatar">RK</span><span style="font-weight:600">R. Kowalski Family</span></div></td><td>$1.8M</td><td>$1.8M</td><td>$240K</td><td style="color:var(--green);font-weight:600">9.4%</td><td><span class="badge badge-green">Current</span></td></tr><tr><td><div style="display:flex;align-items:center;gap:10px"><span class="avatar">BC</span><span style="font-weight:600">Beacon Capital</span></div></td><td>$1.5M</td><td>$1.2M</td><td>$160K</td><td style="color:var(--green);font-weight:600">9.1%</td><td><span class="badge badge-green">Current</span></td></tr><tr><td><div style="display:flex;align-items:center;gap:10px"><span class="avatar">MW</span><span style="font-weight:600">M. Whitmore Trust</span></div></td><td>$1.4M</td><td>$1.1M</td><td>$148K</td><td style="color:var(--blue);font-weight:600">8.6%</td><td><span class="badge badge-blue">On Target</span></td></tr></tbody></table></div>`+cta();}

if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init)}else{init()}
</script>

</body>
</html>
<!-- cache bust 1771951940 -->
